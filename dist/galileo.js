!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=17)}([function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"EPSILON",function(){return d}),n.d(r,"ARRAY_TYPE",function(){return _}),n.d(r,"RANDOM",function(){return p}),n.d(r,"setMatrixArrayType",function(){return v}),n.d(r,"toRadian",function(){return g}),n.d(r,"equals",function(){return M});var i={};n.r(i),n.d(i,"create",function(){return b}),n.d(i,"clone",function(){return x}),n.d(i,"copy",function(){return y}),n.d(i,"identity",function(){return A}),n.d(i,"fromValues",function(){return w}),n.d(i,"set",function(){return T}),n.d(i,"transpose",function(){return E}),n.d(i,"invert",function(){return R}),n.d(i,"adjoint",function(){return F}),n.d(i,"determinant",function(){return P}),n.d(i,"multiply",function(){return S}),n.d(i,"rotate",function(){return L}),n.d(i,"scale",function(){return O}),n.d(i,"fromRotation",function(){return U}),n.d(i,"fromScaling",function(){return I}),n.d(i,"str",function(){return D}),n.d(i,"frob",function(){return C}),n.d(i,"LDU",function(){return B}),n.d(i,"add",function(){return z}),n.d(i,"subtract",function(){return V}),n.d(i,"exactEquals",function(){return q}),n.d(i,"equals",function(){return j}),n.d(i,"multiplyScalar",function(){return N}),n.d(i,"multiplyScalarAndAdd",function(){return k}),n.d(i,"mul",function(){return H}),n.d(i,"sub",function(){return G});var o={};n.r(o),n.d(o,"create",function(){return Y}),n.d(o,"clone",function(){return $}),n.d(o,"copy",function(){return X}),n.d(o,"identity",function(){return K}),n.d(o,"fromValues",function(){return W}),n.d(o,"set",function(){return Q}),n.d(o,"invert",function(){return Z}),n.d(o,"determinant",function(){return J}),n.d(o,"multiply",function(){return tt}),n.d(o,"rotate",function(){return et}),n.d(o,"scale",function(){return nt}),n.d(o,"translate",function(){return rt}),n.d(o,"fromRotation",function(){return it}),n.d(o,"fromScaling",function(){return ot}),n.d(o,"fromTranslation",function(){return at}),n.d(o,"str",function(){return st}),n.d(o,"frob",function(){return ut}),n.d(o,"add",function(){return ct}),n.d(o,"subtract",function(){return ht}),n.d(o,"multiplyScalar",function(){return ft}),n.d(o,"multiplyScalarAndAdd",function(){return lt}),n.d(o,"exactEquals",function(){return dt}),n.d(o,"equals",function(){return _t}),n.d(o,"mul",function(){return pt}),n.d(o,"sub",function(){return vt});var a={};n.r(a),n.d(a,"create",function(){return mt}),n.d(a,"fromMat4",function(){return gt}),n.d(a,"clone",function(){return Mt}),n.d(a,"copy",function(){return bt}),n.d(a,"fromValues",function(){return xt}),n.d(a,"set",function(){return yt}),n.d(a,"identity",function(){return At}),n.d(a,"transpose",function(){return wt}),n.d(a,"invert",function(){return Tt}),n.d(a,"adjoint",function(){return Et}),n.d(a,"determinant",function(){return Rt}),n.d(a,"multiply",function(){return Ft}),n.d(a,"translate",function(){return Pt}),n.d(a,"rotate",function(){return St}),n.d(a,"scale",function(){return Lt}),n.d(a,"fromTranslation",function(){return Ot}),n.d(a,"fromRotation",function(){return Ut}),n.d(a,"fromScaling",function(){return It}),n.d(a,"fromMat2d",function(){return Dt}),n.d(a,"fromQuat",function(){return Ct}),n.d(a,"normalFromMat4",function(){return Bt}),n.d(a,"projection",function(){return zt}),n.d(a,"str",function(){return Vt}),n.d(a,"frob",function(){return qt}),n.d(a,"add",function(){return jt}),n.d(a,"subtract",function(){return Nt}),n.d(a,"multiplyScalar",function(){return kt}),n.d(a,"multiplyScalarAndAdd",function(){return Ht}),n.d(a,"exactEquals",function(){return Gt}),n.d(a,"equals",function(){return Yt}),n.d(a,"mul",function(){return $t}),n.d(a,"sub",function(){return Xt});var s={};n.r(s),n.d(s,"create",function(){return Kt}),n.d(s,"clone",function(){return Wt}),n.d(s,"copy",function(){return Qt}),n.d(s,"fromValues",function(){return Zt}),n.d(s,"set",function(){return Jt}),n.d(s,"identity",function(){return te}),n.d(s,"transpose",function(){return ee}),n.d(s,"invert",function(){return ne}),n.d(s,"adjoint",function(){return re}),n.d(s,"determinant",function(){return ie}),n.d(s,"multiply",function(){return oe}),n.d(s,"translate",function(){return ae}),n.d(s,"scale",function(){return se}),n.d(s,"rotate",function(){return ue}),n.d(s,"rotateX",function(){return ce}),n.d(s,"rotateY",function(){return he}),n.d(s,"rotateZ",function(){return fe}),n.d(s,"fromTranslation",function(){return le}),n.d(s,"fromScaling",function(){return de}),n.d(s,"fromRotation",function(){return _e}),n.d(s,"fromXRotation",function(){return pe}),n.d(s,"fromYRotation",function(){return ve}),n.d(s,"fromZRotation",function(){return me}),n.d(s,"fromRotationTranslation",function(){return ge}),n.d(s,"fromQuat2",function(){return Me}),n.d(s,"getTranslation",function(){return be}),n.d(s,"getScaling",function(){return xe}),n.d(s,"getRotation",function(){return ye}),n.d(s,"fromRotationTranslationScale",function(){return Ae}),n.d(s,"fromRotationTranslationScaleOrigin",function(){return we}),n.d(s,"fromQuat",function(){return Te}),n.d(s,"frustum",function(){return Ee}),n.d(s,"perspective",function(){return Re}),n.d(s,"perspectiveFromFieldOfView",function(){return Fe}),n.d(s,"ortho",function(){return Pe}),n.d(s,"lookAt",function(){return Se}),n.d(s,"targetTo",function(){return Le}),n.d(s,"str",function(){return Oe}),n.d(s,"frob",function(){return Ue}),n.d(s,"add",function(){return Ie}),n.d(s,"subtract",function(){return De}),n.d(s,"multiplyScalar",function(){return Ce}),n.d(s,"multiplyScalarAndAdd",function(){return Be}),n.d(s,"exactEquals",function(){return ze}),n.d(s,"equals",function(){return Ve}),n.d(s,"mul",function(){return qe}),n.d(s,"sub",function(){return je});var u={};n.r(u),n.d(u,"create",function(){return Ne}),n.d(u,"clone",function(){return ke}),n.d(u,"length",function(){return He}),n.d(u,"fromValues",function(){return Ge}),n.d(u,"copy",function(){return Ye}),n.d(u,"set",function(){return $e}),n.d(u,"add",function(){return Xe}),n.d(u,"subtract",function(){return Ke}),n.d(u,"multiply",function(){return We}),n.d(u,"divide",function(){return Qe}),n.d(u,"ceil",function(){return Ze}),n.d(u,"floor",function(){return Je}),n.d(u,"min",function(){return tn}),n.d(u,"max",function(){return en}),n.d(u,"round",function(){return nn}),n.d(u,"scale",function(){return rn}),n.d(u,"scaleAndAdd",function(){return on}),n.d(u,"distance",function(){return an}),n.d(u,"squaredDistance",function(){return sn}),n.d(u,"squaredLength",function(){return un}),n.d(u,"negate",function(){return cn}),n.d(u,"inverse",function(){return hn}),n.d(u,"normalize",function(){return fn}),n.d(u,"dot",function(){return ln}),n.d(u,"cross",function(){return dn}),n.d(u,"lerp",function(){return _n}),n.d(u,"hermite",function(){return pn}),n.d(u,"bezier",function(){return vn}),n.d(u,"random",function(){return mn}),n.d(u,"transformMat4",function(){return gn}),n.d(u,"transformMat3",function(){return Mn}),n.d(u,"transformQuat",function(){return bn}),n.d(u,"rotateX",function(){return xn}),n.d(u,"rotateY",function(){return yn}),n.d(u,"rotateZ",function(){return An}),n.d(u,"angle",function(){return wn}),n.d(u,"str",function(){return Tn}),n.d(u,"exactEquals",function(){return En}),n.d(u,"equals",function(){return Rn}),n.d(u,"sub",function(){return Fn}),n.d(u,"mul",function(){return Pn}),n.d(u,"div",function(){return Sn}),n.d(u,"dist",function(){return Ln}),n.d(u,"sqrDist",function(){return On}),n.d(u,"len",function(){return Un}),n.d(u,"sqrLen",function(){return In}),n.d(u,"forEach",function(){return Dn});var c={};n.r(c),n.d(c,"create",function(){return Cn}),n.d(c,"clone",function(){return Bn}),n.d(c,"fromValues",function(){return zn}),n.d(c,"copy",function(){return Vn}),n.d(c,"set",function(){return qn}),n.d(c,"add",function(){return jn}),n.d(c,"subtract",function(){return Nn}),n.d(c,"multiply",function(){return kn}),n.d(c,"divide",function(){return Hn}),n.d(c,"ceil",function(){return Gn}),n.d(c,"floor",function(){return Yn}),n.d(c,"min",function(){return $n}),n.d(c,"max",function(){return Xn}),n.d(c,"round",function(){return Kn}),n.d(c,"scale",function(){return Wn}),n.d(c,"scaleAndAdd",function(){return Qn}),n.d(c,"distance",function(){return Zn}),n.d(c,"squaredDistance",function(){return Jn}),n.d(c,"length",function(){return tr}),n.d(c,"squaredLength",function(){return er}),n.d(c,"negate",function(){return nr}),n.d(c,"inverse",function(){return rr}),n.d(c,"normalize",function(){return ir}),n.d(c,"dot",function(){return or}),n.d(c,"lerp",function(){return ar}),n.d(c,"random",function(){return sr}),n.d(c,"transformMat4",function(){return ur}),n.d(c,"transformQuat",function(){return cr}),n.d(c,"str",function(){return hr}),n.d(c,"exactEquals",function(){return fr}),n.d(c,"equals",function(){return lr}),n.d(c,"sub",function(){return dr}),n.d(c,"mul",function(){return _r}),n.d(c,"div",function(){return pr}),n.d(c,"dist",function(){return vr}),n.d(c,"sqrDist",function(){return mr}),n.d(c,"len",function(){return gr}),n.d(c,"sqrLen",function(){return Mr}),n.d(c,"forEach",function(){return br});var h={};n.r(h),n.d(h,"create",function(){return xr}),n.d(h,"identity",function(){return yr}),n.d(h,"setAxisAngle",function(){return Ar}),n.d(h,"getAxisAngle",function(){return wr}),n.d(h,"multiply",function(){return Tr}),n.d(h,"rotateX",function(){return Er}),n.d(h,"rotateY",function(){return Rr}),n.d(h,"rotateZ",function(){return Fr}),n.d(h,"calculateW",function(){return Pr}),n.d(h,"slerp",function(){return Sr}),n.d(h,"random",function(){return Lr}),n.d(h,"invert",function(){return Or}),n.d(h,"conjugate",function(){return Ur}),n.d(h,"fromMat3",function(){return Ir}),n.d(h,"fromEuler",function(){return Dr}),n.d(h,"str",function(){return Cr}),n.d(h,"clone",function(){return Br}),n.d(h,"fromValues",function(){return zr}),n.d(h,"copy",function(){return Vr}),n.d(h,"set",function(){return qr}),n.d(h,"add",function(){return jr}),n.d(h,"mul",function(){return Nr}),n.d(h,"scale",function(){return kr}),n.d(h,"dot",function(){return Hr}),n.d(h,"lerp",function(){return Gr}),n.d(h,"length",function(){return Yr}),n.d(h,"len",function(){return $r}),n.d(h,"squaredLength",function(){return Xr}),n.d(h,"sqrLen",function(){return Kr}),n.d(h,"normalize",function(){return Wr}),n.d(h,"exactEquals",function(){return Qr}),n.d(h,"equals",function(){return Zr}),n.d(h,"rotationTo",function(){return Jr}),n.d(h,"sqlerp",function(){return ti}),n.d(h,"setAxes",function(){return ei});var f={};n.r(f),n.d(f,"create",function(){return ni}),n.d(f,"clone",function(){return ri}),n.d(f,"fromValues",function(){return ii}),n.d(f,"fromRotationTranslationValues",function(){return oi}),n.d(f,"fromRotationTranslation",function(){return ai}),n.d(f,"fromTranslation",function(){return si}),n.d(f,"fromRotation",function(){return ui}),n.d(f,"fromMat4",function(){return ci}),n.d(f,"copy",function(){return hi}),n.d(f,"identity",function(){return fi}),n.d(f,"set",function(){return li}),n.d(f,"getReal",function(){return di}),n.d(f,"getDual",function(){return _i}),n.d(f,"setReal",function(){return pi}),n.d(f,"setDual",function(){return vi}),n.d(f,"getTranslation",function(){return mi}),n.d(f,"translate",function(){return gi}),n.d(f,"rotateX",function(){return Mi}),n.d(f,"rotateY",function(){return bi}),n.d(f,"rotateZ",function(){return xi}),n.d(f,"rotateByQuatAppend",function(){return yi}),n.d(f,"rotateByQuatPrepend",function(){return Ai}),n.d(f,"rotateAroundAxis",function(){return wi}),n.d(f,"add",function(){return Ti}),n.d(f,"multiply",function(){return Ei}),n.d(f,"mul",function(){return Ri}),n.d(f,"scale",function(){return Fi}),n.d(f,"dot",function(){return Pi}),n.d(f,"lerp",function(){return Si}),n.d(f,"invert",function(){return Li}),n.d(f,"conjugate",function(){return Oi}),n.d(f,"length",function(){return Ui}),n.d(f,"len",function(){return Ii}),n.d(f,"squaredLength",function(){return Di}),n.d(f,"sqrLen",function(){return Ci}),n.d(f,"normalize",function(){return Bi}),n.d(f,"str",function(){return zi}),n.d(f,"exactEquals",function(){return Vi}),n.d(f,"equals",function(){return qi});var l={};n.r(l),n.d(l,"create",function(){return ji}),n.d(l,"clone",function(){return Ni}),n.d(l,"fromValues",function(){return ki}),n.d(l,"copy",function(){return Hi}),n.d(l,"set",function(){return Gi}),n.d(l,"add",function(){return Yi}),n.d(l,"subtract",function(){return $i}),n.d(l,"multiply",function(){return Xi}),n.d(l,"divide",function(){return Ki}),n.d(l,"ceil",function(){return Wi}),n.d(l,"floor",function(){return Qi}),n.d(l,"min",function(){return Zi}),n.d(l,"max",function(){return Ji}),n.d(l,"round",function(){return to}),n.d(l,"scale",function(){return eo}),n.d(l,"scaleAndAdd",function(){return no}),n.d(l,"distance",function(){return ro}),n.d(l,"squaredDistance",function(){return io}),n.d(l,"length",function(){return oo}),n.d(l,"squaredLength",function(){return ao}),n.d(l,"negate",function(){return so}),n.d(l,"inverse",function(){return uo}),n.d(l,"normalize",function(){return co}),n.d(l,"dot",function(){return ho}),n.d(l,"cross",function(){return fo}),n.d(l,"lerp",function(){return lo}),n.d(l,"random",function(){return _o}),n.d(l,"transformMat2",function(){return po}),n.d(l,"transformMat2d",function(){return vo}),n.d(l,"transformMat3",function(){return mo}),n.d(l,"transformMat4",function(){return go}),n.d(l,"rotate",function(){return Mo}),n.d(l,"angle",function(){return bo}),n.d(l,"str",function(){return xo}),n.d(l,"exactEquals",function(){return yo}),n.d(l,"equals",function(){return Ao}),n.d(l,"len",function(){return wo}),n.d(l,"sub",function(){return To}),n.d(l,"mul",function(){return Eo}),n.d(l,"div",function(){return Ro}),n.d(l,"dist",function(){return Fo}),n.d(l,"sqrDist",function(){return Po}),n.d(l,"sqrLen",function(){return So}),n.d(l,"forEach",function(){return Lo});var d=1e-6,_="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function v(t){_=t}var m=Math.PI/180;function g(t){return t*m}function M(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function b(){var t=new _(4);return _!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function x(t){var e=new _(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function y(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function A(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function w(t,e,n,r){var i=new _(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function T(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function E(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function R(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=n*a,t):null}function F(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function P(t){return t[0]*t[3]-t[2]*t[1]}function S(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*c+o*h,t[3]=i*c+a*h,t}function L(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*-s+o*u,t[3]=i*-s+a*u,t}function O(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=i*s,t[2]=o*u,t[3]=a*u,t}function U(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t}function I(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function D(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function C(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function B(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}function z(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function V(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function q(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function j(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))}function N(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function k(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}var H=S,G=V;function Y(){var t=new _(6);return _!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function $(t){var e=new _(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function X(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function K(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function W(t,e,n,r,i,o){var a=new _(6);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a[4]=i,a[5]=o,a}function Q(t,e,n,r,i,o,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t}function Z(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=n*o-r*i;return u?(u=1/u,t[0]=o*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*s-o*a)*u,t[5]=(r*a-n*s)*u,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],h=n[1],f=n[2],l=n[3],d=n[4],_=n[5];return t[0]=r*c+o*h,t[1]=i*c+a*h,t[2]=r*f+o*l,t[3]=i*f+a*l,t[4]=r*d+o*_+s,t[5]=i*d+a*_+u,t}function et(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+o*c,t[1]=i*h+a*c,t[2]=r*-c+o*h,t[3]=i*-c+a*h,t[4]=s,t[5]=u,t}function nt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],h=n[1];return t[0]=r*c,t[1]=i*c,t[2]=o*h,t[3]=a*h,t[4]=s,t[5]=u,t}function rt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*h+s,t[5]=i*c+a*h+u,t}function it(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function at(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function st(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function ct(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function ht(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function ft(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function lt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function _t(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=e[0],c=e[1],h=e[2],f=e[3],l=e[4],_=e[5];return Math.abs(n-u)<=d*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-h)<=d*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-f)<=d*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-l)<=d*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(s-_)<=d*Math.max(1,Math.abs(s),Math.abs(_))}var pt=tt,vt=ht;function mt(){var t=new _(9);return _!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Mt(t){var e=new _(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function bt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xt(t,e,n,r,i,o,a,s,u){var c=new _(9);return c[0]=t,c[1]=e,c[2]=n,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function yt(t,e,n,r,i,o,a,s,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t}function At(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function wt(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Tt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=h*a-s*c,l=-h*o+s*u,d=c*o-a*u,_=n*f+r*l+i*d;return _?(_=1/_,t[0]=f*_,t[1]=(-h*r+i*c)*_,t[2]=(s*r-i*a)*_,t[3]=l*_,t[4]=(h*n-i*u)*_,t[5]=(-s*n+i*o)*_,t[6]=d*_,t[7]=(-c*n+r*u)*_,t[8]=(a*n-r*o)*_,t):null}function Et(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8];return t[0]=a*h-s*c,t[1]=i*c-r*h,t[2]=r*s-i*a,t[3]=s*u-o*h,t[4]=n*h-i*u,t[5]=i*o-n*s,t[6]=o*c-a*u,t[7]=r*u-n*c,t[8]=n*a-r*o,t}function Rt(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*(c*o-a*u)+n*(-c*i+a*s)+r*(u*i-o*s)}function Ft(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=n[0],d=n[1],_=n[2],p=n[3],v=n[4],m=n[5],g=n[6],M=n[7],b=n[8];return t[0]=l*r+d*a+_*c,t[1]=l*i+d*s+_*h,t[2]=l*o+d*u+_*f,t[3]=p*r+v*a+m*c,t[4]=p*i+v*s+m*h,t[5]=p*o+v*u+m*f,t[6]=g*r+M*a+b*c,t[7]=g*i+M*s+b*h,t[8]=g*o+M*u+b*f,t}function Pt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l*r+d*a+c,t[7]=l*i+d*s+h,t[8]=l*o+d*u+f,t}function St(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=Math.sin(n),d=Math.cos(n);return t[0]=d*r+l*a,t[1]=d*i+l*s,t[2]=d*o+l*u,t[3]=d*a-l*r,t[4]=d*s-l*i,t[5]=d*u-l*o,t[6]=c,t[7]=h,t[8]=f,t}function Lt(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ot(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Ut(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Dt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ct(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,h=r*a,f=r*s,l=i*a,d=i*s,_=i*u,p=o*a,v=o*s,m=o*u;return t[0]=1-f-_,t[3]=h-m,t[6]=l+v,t[1]=h+m,t[4]=1-c-_,t[7]=d-p,t[2]=l-v,t[5]=d+p,t[8]=1-c-f,t}function Bt(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],_=e[12],p=e[13],v=e[14],m=e[15],g=n*s-r*a,M=n*u-i*a,b=n*c-o*a,x=r*u-i*s,y=r*c-o*s,A=i*c-o*u,w=h*p-f*_,T=h*v-l*_,E=h*m-d*_,R=f*v-l*p,F=f*m-d*p,P=l*m-d*v,S=g*P-M*F+b*R+x*E-y*T+A*w;return S?(S=1/S,t[0]=(s*P-u*F+c*R)*S,t[1]=(u*E-a*P-c*T)*S,t[2]=(a*F-s*E+c*w)*S,t[3]=(i*F-r*P-o*R)*S,t[4]=(n*P-i*E+o*T)*S,t[5]=(r*E-n*F-o*w)*S,t[6]=(p*A-v*y+m*x)*S,t[7]=(v*b-_*A-m*M)*S,t[8]=(_*y-p*b+m*g)*S,t):null}function zt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Vt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function qt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function jt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Nt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function kt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Ht(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t}function Gt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Yt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=e[0],l=e[1],_=e[2],p=e[3],v=e[4],m=e[5],g=e[6],M=e[7],b=e[8];return Math.abs(n-f)<=d*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-_)<=d*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-v)<=d*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=d*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-g)<=d*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-M)<=d*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(h-b)<=d*Math.max(1,Math.abs(h),Math.abs(b))}var $t=Ft,Xt=Nt;function Kt(){var t=new _(16);return _!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Wt(t){var e=new _(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Qt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Zt(t,e,n,r,i,o,a,s,u,c,h,f,l,d,p,v){var m=new _(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=a,m[7]=s,m[8]=u,m[9]=c,m[10]=h,m[11]=f,m[12]=l,m[13]=d,m[14]=p,m[15]=v,m}function Jt(t,e,n,r,i,o,a,s,u,c,h,f,l,d,_,p,v){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=c,t[9]=h,t[10]=f,t[11]=l,t[12]=d,t[13]=_,t[14]=p,t[15]=v,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],_=e[12],p=e[13],v=e[14],m=e[15],g=n*s-r*a,M=n*u-i*a,b=n*c-o*a,x=r*u-i*s,y=r*c-o*s,A=i*c-o*u,w=h*p-f*_,T=h*v-l*_,E=h*m-d*_,R=f*v-l*p,F=f*m-d*p,P=l*m-d*v,S=g*P-M*F+b*R+x*E-y*T+A*w;return S?(S=1/S,t[0]=(s*P-u*F+c*R)*S,t[1]=(i*F-r*P-o*R)*S,t[2]=(p*A-v*y+m*x)*S,t[3]=(l*y-f*A-d*x)*S,t[4]=(u*E-a*P-c*T)*S,t[5]=(n*P-i*E+o*T)*S,t[6]=(v*b-_*A-m*M)*S,t[7]=(h*A-l*b+d*M)*S,t[8]=(a*F-s*E+c*w)*S,t[9]=(r*E-n*F-o*w)*S,t[10]=(_*y-p*b+m*g)*S,t[11]=(f*b-h*y-d*g)*S,t[12]=(s*T-a*R-u*w)*S,t[13]=(n*R-r*T+i*w)*S,t[14]=(p*M-_*x-v*g)*S,t[15]=(h*x-f*M+l*g)*S,t):null}function re(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],_=e[12],p=e[13],v=e[14],m=e[15];return t[0]=s*(l*m-d*v)-f*(u*m-c*v)+p*(u*d-c*l),t[1]=-(r*(l*m-d*v)-f*(i*m-o*v)+p*(i*d-o*l)),t[2]=r*(u*m-c*v)-s*(i*m-o*v)+p*(i*c-o*u),t[3]=-(r*(u*d-c*l)-s*(i*d-o*l)+f*(i*c-o*u)),t[4]=-(a*(l*m-d*v)-h*(u*m-c*v)+_*(u*d-c*l)),t[5]=n*(l*m-d*v)-h*(i*m-o*v)+_*(i*d-o*l),t[6]=-(n*(u*m-c*v)-a*(i*m-o*v)+_*(i*c-o*u)),t[7]=n*(u*d-c*l)-a*(i*d-o*l)+h*(i*c-o*u),t[8]=a*(f*m-d*p)-h*(s*m-c*p)+_*(s*d-c*f),t[9]=-(n*(f*m-d*p)-h*(r*m-o*p)+_*(r*d-o*f)),t[10]=n*(s*m-c*p)-a*(r*m-o*p)+_*(r*c-o*s),t[11]=-(n*(s*d-c*f)-a*(r*d-o*f)+h*(r*c-o*s)),t[12]=-(a*(f*v-l*p)-h*(s*v-u*p)+_*(s*l-u*f)),t[13]=n*(f*v-l*p)-h*(r*v-i*p)+_*(r*l-i*f),t[14]=-(n*(s*v-u*p)-a*(r*v-i*p)+_*(r*u-i*s)),t[15]=n*(s*l-u*f)-a*(r*l-i*f)+h*(r*u-i*s),t}function ie(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],d=t[12],_=t[13],p=t[14],v=t[15];return(e*a-n*o)*(f*v-l*p)-(e*s-r*o)*(h*v-l*_)+(e*u-i*o)*(h*p-f*_)+(n*s-r*a)*(c*v-l*d)-(n*u-i*a)*(c*p-f*d)+(r*u-i*s)*(c*_-h*d)}function oe(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],d=e[10],_=e[11],p=e[12],v=e[13],m=e[14],g=e[15],M=n[0],b=n[1],x=n[2],y=n[3];return t[0]=M*r+b*s+x*f+y*p,t[1]=M*i+b*u+x*l+y*v,t[2]=M*o+b*c+x*d+y*m,t[3]=M*a+b*h+x*_+y*g,M=n[4],b=n[5],x=n[6],y=n[7],t[4]=M*r+b*s+x*f+y*p,t[5]=M*i+b*u+x*l+y*v,t[6]=M*o+b*c+x*d+y*m,t[7]=M*a+b*h+x*_+y*g,M=n[8],b=n[9],x=n[10],y=n[11],t[8]=M*r+b*s+x*f+y*p,t[9]=M*i+b*u+x*l+y*v,t[10]=M*o+b*c+x*d+y*m,t[11]=M*a+b*h+x*_+y*g,M=n[12],b=n[13],x=n[14],y=n[15],t[12]=M*r+b*s+x*f+y*p,t[13]=M*i+b*u+x*l+y*v,t[14]=M*o+b*c+x*d+y*m,t[15]=M*a+b*h+x*_+y*g,t}function ae(t,e,n){var r=n[0],i=n[1],o=n[2],a=void 0,s=void 0,u=void 0,c=void 0,h=void 0,f=void 0,l=void 0,d=void 0,_=void 0,p=void 0,v=void 0,m=void 0;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],u=e[2],c=e[3],h=e[4],f=e[5],l=e[6],d=e[7],_=e[8],p=e[9],v=e[10],m=e[11],t[0]=a,t[1]=s,t[2]=u,t[3]=c,t[4]=h,t[5]=f,t[6]=l,t[7]=d,t[8]=_,t[9]=p,t[10]=v,t[11]=m,t[12]=a*r+h*i+_*o+e[12],t[13]=s*r+f*i+p*o+e[13],t[14]=u*r+l*i+v*o+e[14],t[15]=c*r+d*i+m*o+e[15]),t}function se(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,n,r){var i,o,a,s,u,c,h,f,l,_,p,v,m,g,M,b,x,y,A,w,T,E,R,F,P=r[0],S=r[1],L=r[2],O=Math.sqrt(P*P+S*S+L*L);return O<d?null:(P*=O=1/O,S*=O,L*=O,i=Math.sin(n),a=1-(o=Math.cos(n)),s=e[0],u=e[1],c=e[2],h=e[3],f=e[4],l=e[5],_=e[6],p=e[7],v=e[8],m=e[9],g=e[10],M=e[11],b=P*P*a+o,x=S*P*a+L*i,y=L*P*a-S*i,A=P*S*a-L*i,w=S*S*a+o,T=L*S*a+P*i,E=P*L*a+S*i,R=S*L*a-P*i,F=L*L*a+o,t[0]=s*b+f*x+v*y,t[1]=u*b+l*x+m*y,t[2]=c*b+_*x+g*y,t[3]=h*b+p*x+M*y,t[4]=s*A+f*w+v*T,t[5]=u*A+l*w+m*T,t[6]=c*A+_*w+g*T,t[7]=h*A+p*w+M*T,t[8]=s*E+f*R+v*F,t[9]=u*E+l*R+m*F,t[10]=c*E+_*R+g*F,t[11]=h*E+p*R+M*F,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+h*r,t[6]=s*i+f*r,t[7]=u*i+l*r,t[8]=c*i-o*r,t[9]=h*i-a*r,t[10]=f*i-s*r,t[11]=l*i-u*r,t}function he(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=a*i-h*r,t[2]=s*i-f*r,t[3]=u*i-l*r,t[8]=o*r+c*i,t[9]=a*r+h*i,t[10]=s*r+f*i,t[11]=u*r+l*i,t}function fe(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=a*i+h*r,t[2]=s*i+f*r,t[3]=u*i+l*r,t[4]=c*i-o*r,t[5]=h*i-a*r,t[6]=f*i-s*r,t[7]=l*i-u*r,t}function le(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _e(t,e,n){var r,i,o,a=n[0],s=n[1],u=n[2],c=Math.sqrt(a*a+s*s+u*u);return c<d?null:(a*=c=1/c,s*=c,u*=c,r=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=a*a*o+i,t[1]=s*a*o+u*r,t[2]=u*a*o-s*r,t[3]=0,t[4]=a*s*o-u*r,t[5]=s*s*o+i,t[6]=u*s*o+a*r,t[7]=0,t[8]=a*u*o+s*r,t[9]=s*u*o-a*r,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=r+r,u=i+i,c=o+o,h=r*s,f=r*u,l=r*c,d=i*u,_=i*c,p=o*c,v=a*s,m=a*u,g=a*c;return t[0]=1-(d+p),t[1]=f+g,t[2]=l-m,t[3]=0,t[4]=f-g,t[5]=1-(h+p),t[6]=_+v,t[7]=0,t[8]=l+m,t[9]=_-v,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Me(t,e){var n=new _(3),r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=r*r+i*i+o*o+a*a;return f>0?(n[0]=2*(s*a+h*r+u*o-c*i)/f,n[1]=2*(u*a+h*i+c*r-s*o)/f,n[2]=2*(c*a+h*o+s*i-u*r)/f):(n[0]=2*(s*a+h*r+u*o-c*i),n[1]=2*(u*a+h*i+c*r-s*o),n[2]=2*(c*a+h*o+s*i-u*r)),ge(t,e,n),t}function be(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function xe(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(o*o+a*a+s*s),t[2]=Math.sqrt(u*u+c*c+h*h),t}function ye(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function Ae(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=i+i,c=o+o,h=a+a,f=i*u,l=i*c,d=i*h,_=o*c,p=o*h,v=a*h,m=s*u,g=s*c,M=s*h,b=r[0],x=r[1],y=r[2];return t[0]=(1-(_+v))*b,t[1]=(l+M)*b,t[2]=(d-g)*b,t[3]=0,t[4]=(l-M)*x,t[5]=(1-(f+v))*x,t[6]=(p+m)*x,t[7]=0,t[8]=(d+g)*y,t[9]=(p-m)*y,t[10]=(1-(f+_))*y,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function we(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,h=a+a,f=s+s,l=o*c,d=o*h,_=o*f,p=a*h,v=a*f,m=s*f,g=u*c,M=u*h,b=u*f,x=r[0],y=r[1],A=r[2],w=i[0],T=i[1],E=i[2],R=(1-(p+m))*x,F=(d+b)*x,P=(_-M)*x,S=(d-b)*y,L=(1-(l+m))*y,O=(v+g)*y,U=(_+M)*A,I=(v-g)*A,D=(1-(l+p))*A;return t[0]=R,t[1]=F,t[2]=P,t[3]=0,t[4]=S,t[5]=L,t[6]=O,t[7]=0,t[8]=U,t[9]=I,t[10]=D,t[11]=0,t[12]=n[0]+w-(R*w+S*T+U*E),t[13]=n[1]+T-(F*w+L*T+I*E),t[14]=n[2]+E-(P*w+O*T+D*E),t[15]=1,t}function Te(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,h=r*a,f=r*s,l=i*a,d=i*s,_=i*u,p=o*a,v=o*s,m=o*u;return t[0]=1-f-_,t[1]=h+m,t[2]=l-v,t[3]=0,t[4]=h-m,t[5]=1-c-_,t[6]=d+p,t[7]=0,t[8]=l+v,t[9]=d-p,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ee(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),c=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function Re(t,e,n,r,i){var o=1/Math.tan(e/2),a=void 0;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function Fe(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(i-o)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Pe(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1,t}function Se(t,e,n,r){var i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,h=void 0,f=void 0,l=void 0,_=void 0,p=e[0],v=e[1],m=e[2],g=r[0],M=r[1],b=r[2],x=n[0],y=n[1],A=n[2];return Math.abs(p-x)<d&&Math.abs(v-y)<d&&Math.abs(m-A)<d?te(t):(h=p-x,f=v-y,l=m-A,i=M*(l*=_=1/Math.sqrt(h*h+f*f+l*l))-b*(f*=_),o=b*(h*=_)-g*l,a=g*f-M*h,(_=Math.sqrt(i*i+o*o+a*a))?(i*=_=1/_,o*=_,a*=_):(i=0,o=0,a=0),s=f*a-l*o,u=l*i-h*a,c=h*o-f*i,(_=Math.sqrt(s*s+u*u+c*c))?(s*=_=1/_,u*=_,c*=_):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=o,t[5]=u,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=l,t[11]=0,t[12]=-(i*p+o*v+a*m),t[13]=-(s*p+u*v+c*m),t[14]=-(h*p+f*v+l*m),t[15]=1,t)}function Le(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=r[0],u=r[1],c=r[2],h=i-n[0],f=o-n[1],l=a-n[2],d=h*h+f*f+l*l;d>0&&(h*=d=1/Math.sqrt(d),f*=d,l*=d);var _=u*l-c*f,p=c*h-s*l,v=s*f-u*h;return(d=_*_+p*p+v*v)>0&&(_*=d=1/Math.sqrt(d),p*=d,v*=d),t[0]=_,t[1]=p,t[2]=v,t[3]=0,t[4]=f*v-l*p,t[5]=l*_-h*v,t[6]=h*p-f*_,t[7]=0,t[8]=h,t[9]=f,t[10]=l,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Oe(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ue(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Ie(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function De(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function Ce(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Be(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function ze(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Ve(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=t[8],f=t[9],l=t[10],_=t[11],p=t[12],v=t[13],m=t[14],g=t[15],M=e[0],b=e[1],x=e[2],y=e[3],A=e[4],w=e[5],T=e[6],E=e[7],R=e[8],F=e[9],P=e[10],S=e[11],L=e[12],O=e[13],U=e[14],I=e[15];return Math.abs(n-M)<=d*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(r-b)<=d*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(i-x)<=d*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-y)<=d*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-A)<=d*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(s-w)<=d*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(u-T)<=d*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-E)<=d*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(h-R)<=d*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(f-F)<=d*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(l-P)<=d*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(_-S)<=d*Math.max(1,Math.abs(_),Math.abs(S))&&Math.abs(p-L)<=d*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(v-O)<=d*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(m-U)<=d*Math.max(1,Math.abs(m),Math.abs(U))&&Math.abs(g-I)<=d*Math.max(1,Math.abs(g),Math.abs(I))}var qe=oe,je=De;function Ne(){var t=new _(3);return _!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ke(t){var e=new _(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function He(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function Ge(t,e,n){var r=new _(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function $e(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Xe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ke(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function We(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Qe(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Ze(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Je(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function en(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function nn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function rn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function on(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function an(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function sn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function un(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function cn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function hn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function fn(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function ln(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function dn(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function _n(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function pn(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*h,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*h,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*h,t}function vn(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,h=3*o*s,f=3*u*a,l=u*o;return t[0]=e[0]*c+n[0]*h+r[0]*f+i[0]*l,t[1]=e[1]*c+n[1]*h+r[1]*f+i[1]*l,t[2]=e[2]*c+n[2]*h+r[2]*f+i[2]*l,t}function mn(t,e){e=e||1;var n=2*p()*Math.PI,r=2*p()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function gn(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function Mn(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function bn(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],h=i*c-o*u,f=o*s-r*c,l=r*u-i*s,d=i*l-o*f,_=o*h-r*l,p=r*f-i*h,v=2*a;return h*=v,f*=v,l*=v,d*=2,_*=2,p*=2,t[0]=s+h+d,t[1]=u+f+_,t[2]=c+l+p,t}function xn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function yn(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function An(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function wn(t,e){var n=Ge(t[0],t[1],t[2]),r=Ge(e[0],e[1],e[2]);fn(n,n),fn(r,r);var i=ln(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Tn(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function En(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Rn(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=d*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))}var Fn=Ke,Pn=We,Sn=Qe,Ln=an,On=sn,Un=He,In=un,Dn=function(){var t=Ne();return function(e,n,r,i,o,a){var s=void 0,u=void 0;for(n||(n=3),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}();function Cn(){var t=new _(4);return _!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Bn(t){var e=new _(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function zn(t,e,n,r){var i=new _(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Vn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function qn(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function jn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Nn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function kn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Hn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Gn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Yn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function $n(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function Xn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function Kn(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Wn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Qn(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t}function Zn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+o*o)}function Jn(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return n*n+r*r+i*i+o*o}function tr(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function er(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function nr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function rr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function ir(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t}function or(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ar(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function sr(t,e){var n,r,i,o,a,s;e=e||1;do{a=(n=2*p()-1)*n+(r=2*p()-1)*r}while(a>=1);do{s=(i=2*p()-1)*i+(o=2*p()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return t[0]=e*n,t[1]=e*r,t[2]=e*i*u,t[3]=e*o*u,t}function ur(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function cr(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],c=n[3],h=c*r+s*o-u*i,f=c*i+u*r-a*o,l=c*o+a*i-s*r,d=-a*r-s*i-u*o;return t[0]=h*c+d*-a+f*-u-l*-s,t[1]=f*c+d*-s+l*-a-h*-u,t[2]=l*c+d*-u+h*-s-f*-a,t[3]=e[3],t}function hr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function fr(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function lr(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],s=e[1],u=e[2],c=e[3];return Math.abs(n-a)<=d*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))}var dr=Nn,_r=kn,pr=Hn,vr=Zn,mr=Jn,gr=tr,Mr=er,br=function(){var t=Cn();return function(e,n,r,i,o,a){var s=void 0,u=void 0;for(n||(n=4),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();function xr(){var t=new _(4);return _!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function yr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ar(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function wr(t,e){var n=2*Math.acos(e[3]),r=Math.sin(n/2);return r>d?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Tr(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+a*s+i*c-o*u,t[1]=i*h+a*u+o*s-r*c,t[2]=o*h+a*c+r*u-i*s,t[3]=a*h-r*s-i*u-o*c,t}function Er(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function Rr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function Fr(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function Pr(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Sr(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=n[0],c=n[1],h=n[2],f=n[3],l=void 0,_=void 0,p=void 0,v=void 0,m=void 0;return(_=i*u+o*c+a*h+s*f)<0&&(_=-_,u=-u,c=-c,h=-h,f=-f),1-_>d?(l=Math.acos(_),p=Math.sin(l),v=Math.sin((1-r)*l)/p,m=Math.sin(r*l)/p):(v=1-r,m=r),t[0]=v*i+m*u,t[1]=v*o+m*c,t[2]=v*a+m*h,t[3]=v*s+m*f,t}function Lr(t){var e=p(),n=p(),r=p(),i=Math.sqrt(1-e),o=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=o*Math.sin(2*Math.PI*r),t[3]=o*Math.cos(2*Math.PI*r),t}function Or(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function Ur(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ir(t,e){var n=e[0]+e[4]+e[8],r=void 0;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*a+a]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*o+a]-e[3*a+o])*r,t[o]=(e[3*o+i]+e[3*i+o])*r,t[a]=(e[3*a+i]+e[3*i+a])*r}return t}function Dr(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return t[0]=o*u*h-a*s*c,t[1]=a*s*h+o*u*c,t[2]=a*u*c-o*s*h,t[3]=a*u*h+o*s*c,t}function Cr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Br=Bn,zr=zn,Vr=Vn,qr=qn,jr=jn,Nr=Tr,kr=Wn,Hr=or,Gr=ar,Yr=tr,$r=Yr,Xr=er,Kr=Xr,Wr=ir,Qr=fr,Zr=lr,Jr=function(){var t=Ne(),e=Ge(1,0,0),n=Ge(0,1,0);return function(r,i,o){var a=ln(i,o);return a<-.999999?(dn(t,e,i),Un(t)<1e-6&&dn(t,n,i),fn(t,t),Ar(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(dn(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,Wr(r,r))}}(),ti=function(){var t=xr(),e=xr();return function(n,r,i,o,a,s){return Sr(t,r,a,s),Sr(e,i,o,s),Sr(n,t,e,2*s*(1-s)),n}}(),ei=function(){var t=mt();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],Wr(e,Ir(e,t))}}();function ni(){var t=new _(8);return _!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function ri(t){var e=new _(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function ii(t,e,n,r,i,o,a,s){var u=new _(8);return u[0]=t,u[1]=e,u[2]=n,u[3]=r,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u}function oi(t,e,n,r,i,o,a){var s=new _(8);s[0]=t,s[1]=e,s[2]=n,s[3]=r;var u=.5*i,c=.5*o,h=.5*a;return s[4]=u*r+c*n-h*e,s[5]=c*r+h*t-u*n,s[6]=h*r+u*e-c*t,s[7]=-u*t-c*e-h*n,s}function ai(t,e,n){var r=.5*n[0],i=.5*n[1],o=.5*n[2],a=e[0],s=e[1],u=e[2],c=e[3];return t[0]=a,t[1]=s,t[2]=u,t[3]=c,t[4]=r*c+i*u-o*s,t[5]=i*c+o*a-r*u,t[6]=o*c+r*s-i*a,t[7]=-r*a-i*s-o*u,t}function si(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function ui(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ci(t,e){var n=xr();ye(n,e);var r=new _(3);return be(r,e),ai(t,n,r),t}function hi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function fi(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function li(t,e,n,r,i,o,a,s,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t}var di=Vr;function _i(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var pi=Vr;function vi(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function mi(t,e){var n=e[4],r=e[5],i=e[6],o=e[7],a=-e[0],s=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+o*a+r*u-i*s),t[1]=2*(r*c+o*s+i*a-n*u),t[2]=2*(i*c+o*u+n*s-r*a),t}function gi(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=.5*n[0],u=.5*n[1],c=.5*n[2],h=e[4],f=e[5],l=e[6],d=e[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=a*s+i*c-o*u+h,t[5]=a*u+o*s-r*c+f,t[6]=a*c+r*u-i*s+l,t[7]=-r*s-i*u-o*c+d,t}function Mi(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=s*a+h*r+u*o-c*i,l=u*a+h*i+c*r-s*o,d=c*a+h*o+s*i-u*r,_=h*a-s*r-u*i-c*o;return Er(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+_*r+l*o-d*i,t[5]=l*a+_*i+d*r-f*o,t[6]=d*a+_*o+f*i-l*r,t[7]=_*a-f*r-l*i-d*o,t}function bi(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=s*a+h*r+u*o-c*i,l=u*a+h*i+c*r-s*o,d=c*a+h*o+s*i-u*r,_=h*a-s*r-u*i-c*o;return Rr(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+_*r+l*o-d*i,t[5]=l*a+_*i+d*r-f*o,t[6]=d*a+_*o+f*i-l*r,t[7]=_*a-f*r-l*i-d*o,t}function xi(t,e,n){var r=-e[0],i=-e[1],o=-e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],f=s*a+h*r+u*o-c*i,l=u*a+h*i+c*r-s*o,d=c*a+h*o+s*i-u*r,_=h*a-s*r-u*i-c*o;return Fr(t,e,n),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+_*r+l*o-d*i,t[5]=l*a+_*i+d*r-f*o,t[6]=d*a+_*o+f*i-l*r,t[7]=_*a-f*r-l*i-d*o,t}function yi(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],h=e[3];return t[0]=s*a+h*r+u*o-c*i,t[1]=u*a+h*i+c*r-s*o,t[2]=c*a+h*o+s*i-u*r,t[3]=h*a-s*r-u*i-c*o,s=e[4],u=e[5],c=e[6],h=e[7],t[4]=s*a+h*r+u*o-c*i,t[5]=u*a+h*i+c*r-s*o,t[6]=c*a+h*o+s*i-u*r,t[7]=h*a-s*r-u*i-c*o,t}function Ai(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+a*s+i*c-o*u,t[1]=i*h+a*u+o*s-r*c,t[2]=o*h+a*c+r*u-i*s,t[3]=a*h-r*s-i*u-o*c,s=n[4],u=n[5],c=n[6],h=n[7],t[4]=r*h+a*s+i*c-o*u,t[5]=i*h+a*u+o*s-r*c,t[6]=o*h+a*c+r*u-i*s,t[7]=a*h-r*s-i*u-o*c,t}function wi(t,e,n,r){if(Math.abs(r)<d)return hi(t,e);var i=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);r*=.5;var o=Math.sin(r),a=o*n[0]/i,s=o*n[1]/i,u=o*n[2]/i,c=Math.cos(r),h=e[0],f=e[1],l=e[2],_=e[3];t[0]=h*c+_*a+f*u-l*s,t[1]=f*c+_*s+l*a-h*u,t[2]=l*c+_*u+h*s-f*a,t[3]=_*c-h*a-f*s-l*u;var p=e[4],v=e[5],m=e[6],g=e[7];return t[4]=p*c+g*a+v*u-m*s,t[5]=v*c+g*s+m*a-p*u,t[6]=m*c+g*u+p*s-v*a,t[7]=g*c-p*a-v*s-m*u,t}function Ti(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Ei(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[4],u=n[5],c=n[6],h=n[7],f=e[4],l=e[5],d=e[6],_=e[7],p=n[0],v=n[1],m=n[2],g=n[3];return t[0]=r*g+a*p+i*m-o*v,t[1]=i*g+a*v+o*p-r*m,t[2]=o*g+a*m+r*v-i*p,t[3]=a*g-r*p-i*v-o*m,t[4]=r*h+a*s+i*c-o*u+f*g+_*p+l*m-d*v,t[5]=i*h+a*u+o*s-r*c+l*g+_*v+d*p-f*m,t[6]=o*h+a*c+r*u-i*s+d*g+_*m+f*v-l*p,t[7]=a*h-r*s-i*u-o*c+_*g-f*p-l*v-d*m,t}var Ri=Ei;function Fi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Pi=Hr;function Si(t,e,n,r){var i=1-r;return Pi(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t}function Li(t,e){var n=Di(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Oi(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Ui=Yr,Ii=Ui,Di=Xr,Ci=Di;function Bi(t,e){var n=Di(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,o=e[2]/n,a=e[3]/n,s=e[4],u=e[5],c=e[6],h=e[7],f=r*s+i*u+o*c+a*h;t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=(s-r*f)/n,t[5]=(u-i*f)/n,t[6]=(c-o*f)/n,t[7]=(h-a*f)/n}return t}function zi(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Vi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function qi(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],h=e[0],f=e[1],l=e[2],_=e[3],p=e[4],v=e[5],m=e[6],g=e[7];return Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-_)<=d*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(u-m)<=d*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))}function ji(){var t=new _(2);return _!=Float32Array&&(t[0]=0,t[1]=0),t}function Ni(t){var e=new _(2);return e[0]=t[0],e[1]=t[1],e}function ki(t,e){var n=new _(2);return n[0]=t,n[1]=e,n}function Hi(t,e){return t[0]=e[0],t[1]=e[1],t}function Gi(t,e,n){return t[0]=e,t[1]=n,t}function Yi(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function $i(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Xi(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Ki(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function Wi(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Qi(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Zi(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Ji(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function to(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function eo(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function no(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function ro(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function io(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function oo(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function ao(t){var e=t[0],n=t[1];return e*e+n*n}function so(t,e){return t[0]=-e[0],t[1]=-e[1],t}function uo(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function co(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t}function ho(t,e){return t[0]*e[0]+t[1]*e[1]}function fo(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function lo(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function _o(t,e){e=e||1;var n=2*p()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function po(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function vo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function mo(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function go(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function Mo(t,e,n,r){var i=e[0]-n[0],o=e[1]-n[1],a=Math.sin(r),s=Math.cos(r);return t[0]=i*s-o*a+n[0],t[1]=i*a+o*s+n[1],t}function bo(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));var s=i*i+o*o;s>0&&(s=1/Math.sqrt(s));var u=(n*i+r*o)*a*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function xo(t){return"vec2("+t[0]+", "+t[1]+")"}function yo(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ao(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=d*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))}var wo=oo,To=$i,Eo=Xi,Ro=Ki,Fo=ro,Po=io,So=ao,Lo=function(){var t=ji();return function(e,n,r,i,o,a){var s=void 0,u=void 0;for(n||(n=2),r||(r=0),u=i?Math.min(i*n+r,e.length):e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}();n.d(e,"glMatrix",function(){return r}),n.d(e,"mat2",function(){return i}),n.d(e,"mat2d",function(){return o}),n.d(e,"mat3",function(){return a}),n.d(e,"mat4",function(){return s}),n.d(e,"quat",function(){return h}),n.d(e,"quat2",function(){return f}),n.d(e,"vec2",function(){return l}),n.d(e,"vec3",function(){return u}),n.d(e,"vec4",function(){return c})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);function i(t){return r.vec3.fromValues(t,t,t)}function o(...t){return t.reduce((t,e)=>r.vec3.add(t,t,e),i(0))}function a(...t){return t.reduce((t,e)=>r.vec3.mul(t,t,e),i(1))}function s(t,e){return a(t,[e,e,e])}function u(t){return r.vec3.fromValues(t[0],t[1],t[2])}e.vec=function(t,e,n){return r.vec3.fromValues(t,e,n)},e.fill=i,e.sum=o,e.prod=a,e.div=function(t,e){const n=r.vec3.create();return r.vec3.div(n,t,e)},e.sub=function(t,e){const n=r.vec3.create();return r.vec3.sub(n,t,e)},e.times=s,e.scale=s,e.centroid=function(...t){return e.scale(o(...t),1/t.length)},e.normalize=function(t){const e=r.vec3.create();return r.vec3.normalize(e,t),e},e.vec3FromVec4=u,e.transform=function(t,e){const n=r.vec4.fromValues(t[0],t[1],t[2],1);return r.vec4.transformMat4(n,n,e),u(n)},e.rotate=function(t,e){const n=r.vec3.create();return r.vec3.transformQuat(n,t,e),r.vec3.normalize(n,n),n},e.cross=function(t,e){const n=r.vec3.create();return r.vec3.cross(n,t,e)},e.lerp=function(t,e,n){const i=r.vec3.create();return r.vec3.lerp(i,t,e,n)},e.collinear=function(t,e,n=1e-4){return Math.abs(Math.abs(r.vec3.dot(t,e)/(r.vec3.len(t)*r.vec3.len(e)))-1)<n}},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.INT=0]="INT",t[t.FLOAT=1]="FLOAT",t[t.VEC2=2]="VEC2",t[t.VEC3=3]="VEC3",t[t.VEC4=4]="VEC4",t[t.MAT4=5]="MAT4"}(r=e.UniformType||(e.UniformType={}));class i{constructor(t,e){this._compiled=!1,this.gl=t,this._source=e,this._uniforms=new Map,this._definitions=new Map}preprocess(t){return`#version ${i.version}\n        ${[...this._definitions].map(([t,e])=>`\n#define ${t} ${e}`).join("")}\n        ${t}\n        `}compile(){if(this._compiled)return;this._uniforms.forEach(t=>t.location=null);const t=this.preprocess(this._source.vertex),e=this.preprocess(this._source.fragment);this._vertex_shader=this.createShader(this.gl.VERTEX_SHADER,t),this._fragment_shader=this.createShader(this.gl.FRAGMENT_SHADER,e),this._program=this.createProgram(),this._compiled=!0}use(){this.compile(),this.gl.useProgram(this._program)}define(t,e=""){this._definitions.set(t,e),this._compiled=!1}defineFloat(t,e){let n=e.toString();n=(n.includes(".")?n:`${n}.0`)+"f",this.define(t,n)}defineInt(t,e){this.define(t,parseInt(e.toString()).toString())}undefine(t){this._definitions.delete(t),this._compiled=!1}createShader(t,e){const n=this.gl.createShader(t);if(this.gl.shaderSource(n,e),this.gl.compileShader(n),!this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)){const t=this.gl.getShaderInfoLog(n);throw this.gl.deleteShader(n),new Error(t)}return n}createProgram(){const t=this.gl.createProgram();if(this.gl.attachShader(t,this._vertex_shader),this.gl.attachShader(t,this._fragment_shader),this.gl.linkProgram(t),!this.gl.getProgramParameter(t,this.gl.LINK_STATUS)){const e=this.gl.getProgramInfoLog(t);throw this.gl.deleteProgram(t),new Error(e)}return t}get program(){return this._program}getAttribLocation(t){return this.gl.getAttribLocation(this._program,t)}registerUniform(t,e,n,r=!1){this._uniforms.has(t)?this._uniforms.get(t).value=e:this._uniforms.set(t,{location:null,value:e,type:n,transpose:r})}registerTexture(t,e){this.setInt(t,e)}bindUniforms(){for(const[t,e]of this._uniforms)null===e.location&&(e.location=this.gl.getUniformLocation(this._program,t)),this.setUniform(e)}setFloat(t,e){this.registerUniform(t,e,r.FLOAT)}setInt(t,e){this.registerUniform(t,e,r.INT)}setBool(t,e){this.setInt(t,e?1:0)}setVec2(t,e){this.registerUniform(t,e,r.VEC2)}setVec3(t,e){this.registerUniform(t,e,r.VEC3)}setVec4(t,e){this.registerUniform(t,e,r.VEC4)}setMat4(t,e,n=!1){this.registerUniform(t,e,r.MAT4,n)}setArray(t,e,n){for(let r=0;r<e.length;r++)this.registerUniform(`${t}[${r}]`,e[r],n)}setUniform(t){if(null!==t.location)switch(t.type){case r.INT:this.gl.uniform1i(t.location,t.value);break;case r.FLOAT:this.gl.uniform1f(t.location,t.value);break;case r.VEC2:this.gl.uniform2fv(t.location,t.value);break;case r.VEC3:this.gl.uniform3fv(t.location,t.value);break;case r.VEC4:this.gl.uniform4fv(t.location,t.value);break;case r.MAT4:this.gl.uniformMatrix4fv(t.location,t.transpose,t.value);break;default:throw new Error(`Unrecognised UniformType: ${t.type} with value: ${t.value}`)}}}i.version="300 es",e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);e.degrees=(t=>57.29577951308232*t%360),e.radians=(t=>.017453292519943295*t%6.283185307179586),e.kph_to_kps=(t=>t/3600),e.kps_to_kph=(t=>3600*t),e.clamp=((t,e,n)=>Math.min(Math.max(t,e),n)),e.total=((...t)=>t.reduce((t,e)=>t+e,0)),e.average=((...t)=>0!==t.length?e.total(...t)/t.length:0),e.combineMatrices=function(...t){const e=r.mat4.clone(t[0]);for(let n=1;n<t.length;n++)r.mat4.mul(e,e,t[n]);return e},e.invert=function(t){const e=r.mat4.create();return r.mat4.invert(e,t)},e.randomMat4=function(t=(()=>Math.random())){return new Float32Array(16).map(t)},e.triangleHypotenuse=function(t,e,n){return s([{from:t,to:e,other:n,len:r.vec3.dist(t,e)},{from:t,to:n,other:e,len:r.vec3.dist(t,n)},{from:e,to:n,other:t,len:r.vec3.dist(e,n)}],t=>t.len)},e.mapIntervals=((t,e,n,r,i)=>r+(t-e)*(i-r)/(n-e)),e.getAltitude=((t,e,n)=>Math.max(r.vec3.dist(t,e)-n,0)),e.getNormalizedAltitude=((t,e,n)=>2/(1+Math.exp(-this.getAltitude(t,e,n)/n))-1);const i=[1,1e3,149597870700,9454254955488e3].reverse(),o=["m","km","au","ly"].reverse();function a(t,e){let n=-1,r=1/0;for(let i=0;i<t.length;i++){const o=e(t[i]);o<r&&(r=o,n=i)}return t[n]}function s(t,e){return a(t,t=>-e(t))}e.formatDistance=function(t,e=5){let n=t<=1?o.length-1:i.findIndex(e=>t>e);return`${(t/i[n]).toPrecision(e)}${o[n]} `},e.minimize=a,e.maximize=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(3);function o(t,e=3){return new Float32Array(e).fill(t)}function a(t,e){const n=new Float32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]+e[r];return n}function s(...t){return t.reduce((t,e)=>a(t,e),o(0,t[0].length))}function u(t,e){const n=new Float32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]-e[r];return n}function c(t,e){return t.map(t=>t*e)}function h(t){return t.reduce((t,e)=>t+e**2,0)**.5}function f(t,e){const n=[];for(let r=0;r<e;r++)n.push(t);return n}e.g_vec=function(...t){return new Float32Array(t)},e.g_fill=o,e.g_add=a,e.g_sum=s,e.g_prod=function(...t){const e=o(1,t[0].length);for(const n of t)for(let t=0;t<e.length;t++)e[t]*=n[t];return e},e.g_div=function(t,e){const n=new Float32Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]/e[r];return n},e.g_sub=u,e.g_times=c,e.g_scale=c,e.g_clone=function(t){return new Float32Array(t)},e.g_centroid=function(...t){return e.g_scale(s(...t),1/t.length)},e.g_len=h,e.g_normalize=function(t){const n=h(t);return 0!==n?e.g_scale(t,1/n):o(0,t.length)},e.g_equals=function(t,e){return t.length===e.length&&t.every((t,n)=>r.glMatrix.equals(t,e[n]))},e.g_dot=function(t,e){return t.reduce((t,n,r)=>t+n*e[r],0)},e.dist=function(t,e){return h(u(t,e))},e.fillArray=f,e.getBoundingBox=function(...t){const e=t[0].length,n=f(1/0,e),r=f(-1/0,e);for(const i of t)for(let t=0;t<e;t++)i[t]<n[t]?n[t]=i[t]:i[t]>r[t]&&(r[t]=i[t]);return{min:n,max:r}},e.mapBox=function(t,e,n){const r=t.length,o=[];for(let a=0;a<r;a++)o[a]=i.mapIntervals(t[a],e.min[a],e.max[a],n.min[a],n.max[a]);return o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(6);e.getMorphFactor=((t="getMorphFactor",e="distanceLUT")=>r.preprocessor_isolate(t,`\n        float ${t}(const float dist, const int level, const float morph_range) {\n            float low = ${e}[level - 1];\n            float high = ${e}[level];\n            \n            float a = (dist - low) / (high - low);\n        \n            return 1.0 - clamp(a / morph_range, 0.0, 1.0);\n        }\n    `)),e.getPatchPosition=((t="getPatchPosition")=>r.preprocessor_isolate(t,`\n\n        ${e.getMorphFactor()}\n\n        vec3 ${t}(\n            const vec3 A, \n            const vec3 R, \n            const vec3 S, \n            const vec2 pos,\n            const vec2 morph,\n            const vec3 cam_pos,\n            const int level,\n            const float morph_range\n            ){\n                vec3 tri_pos = A + R * pos.x + S * pos.y;\n                float dist = distance(cam_pos, tri_pos);\n                float factor = getMorphFactor(dist, v_level, morph_range);\n                tri_pos += factor * (R * morph.x + S * morph.y);\n        \n                return tri_pos;\n            } \n        `)),e.getLevelColor=((t="getLevelColor")=>r.preprocessor_isolate(t,`\n        vec3 ${t}(const int level) {\n            if (level == 9) {\n                return vec3(1.0);\n            } if (level == 8) {\n                return vec3(0, 0.5, 0.5);\n            } else if (level == 7) {\n                return vec3(1.0, 0.0, 0.0);\n            } else if (level == 6) {\n                return vec3(0.0, 1.0, 0.0);\n            } else if (level == 5) {\n                return vec3(1.0, 0.0, 1.0);\n            } else if (level == 4) {\n                return vec3(0.0, 1.0, 1.0);\n            } else if (level == 3) {\n                return vec3(1.0, 1.0, 0.0);\n            } else if (level == 2) {\n                return vec3(0.0, 0.5, 0.5);\n            } else if (level == 1) {\n                return vec3(1.0, 0.0, 0.5);\n            } else if (level == 0) {\n                return vec3(1.0);\n            }\n        \n            return vec3(1.0, 0.0, 1.0);\n        }\n    `)),e.getFaceNormal=((t="getFaceNormal")=>r.preprocessor_isolate(t,`\n        vec3 ${t}(const vec3 frag_pos) {\n            vec3 fdx = vec3(dFdx(frag_pos.x), dFdx(frag_pos.y), dFdx(frag_pos.z));\n            vec3 fdy = vec3(dFdy(frag_pos.x), dFdy(frag_pos.y), dFdy(frag_pos.z));\n            vec3 normal = normalize(cross(fdx, fdy));\n            return normal;\n        }\n    `)),e.spherize=((t="spherize")=>r.preprocessor_isolate(t,`\n        vec3 ${t}(vec2 st) {\n            float theta = st.y * 3.14159265359;\n            float phi = st.x * 6.28318530718;\n            float cos_theta = cos(theta);\n            float cos_phi = cos(phi);\n            float sin_theta = sin(theta);\n            float sin_phi = sin(phi);\n            float x = sin_theta * cos_phi;\n            float y = sin_theta * sin_phi;\n            float z = cos_theta;\n        \n            return vec3(x, y, z);\n        }\n    `))},function(t,e,n){"use strict";function r(t){return t.split(/(?=[A-Z])/).join("_")}Object.defineProperty(e,"__esModule",{value:!0}),e.snake_casify=r,e.preprocessor_isolate=function(t,e){return`\n        #ifndef ${t=r(t).toUpperCase()}\n            #define ${t}\n            ${e}\n        #endif\n    `}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(18);class i extends r.default{constructor(t=document){super(),["keydown","keyup","mousemove","pointerlockchange","pointerlockerror"].forEach(e=>{t.addEventListener(e,t=>this.emit(e,t),!1)})}onKeyDown(t){this.on("keydown",t)}onKeyUp(t){this.on("keyup",t)}onMouseMove(t){this.on("mousemove",t)}onPointerLockChange(t){this.on("pointerlockchange",t)}onPointerLockError(t){this.on("pointerlockerror",t)}static get instance(){return void 0===i._instance&&(i._instance=new i),i._instance}}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(6);e.getTerrainColor=((t="getTerrainColor")=>r.preprocessor_isolate(t,`\n        vec3 ${t}(float n) {\n            if (n == 0.0f) {\n                // return vec3(28.0f, 58.0f, 106.0f) / vec3(255.0f);\n                // return vec3(0.0, 0.5, 0.5);\n                return vec3(0.302f, 0.388f, 0.714f); //water\n            } else if (n < 0.4f) {\n                return mix(vec3(0.239f, 0.614f, 0.214f), vec3(0.686f, 0.671f, 0.412f), smoothstep(0.0f, 0.4f, n)); //land\n            } else if (n < 0.7f) {\n                vec3 color1 = vec3(0.686f, 0.671f, 0.412f);\n                vec3 color2 = vec3(0.486f, 0.371f, 0.312f);\n                return mix(color1, color2, smoothstep(0.4f, 0.7f, n));\n            } else {\n                return mix(vec3(0.486f, 0.371f, 0.312f), vec3(0.949f, 0.949f, 0.949f), smoothstep(0.7f, 1.0f, n)); //mountains\n            }\n        }\n    `))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(2),o=n(1),a=n(3),s=n(26);class u{constructor(t,e={},n){this._ID=u.count++,this._first_update=!0,this._needs_model_mat_update=!0,this.gl=t,this._options=Object.assign({radius:1,center:o.fill(0),orientation:r.quat.create(),max_lod:6,patch_levels:4,max_terrain_height:400,max_edge_size:150,morph_range:.5},e),this._vertices=this.initVertices(),this._vertex_index_map=new Map,this.computeModelMatrix(),this._shader=n instanceof i.default?n:new i.default(t,n),this._patch=this.initPatch()}init(t){this._faces=this.initFaces(),this._frustum=new s.default(t),this.updateLookUpTables(t),this._patch.init()}updateLookUpTables(t){this.generateFaceCullingAnglesLUT(),this.generateSplitDistancesLUT(t.FOV)}computeModelMatrix(){void 0===this._model_matrix&&(this._model_matrix=r.mat4.create()),r.mat4.fromRotationTranslationScale(this._model_matrix,this._options.orientation,this._options.center,o.fill(this._options.radius)),this._inv_model_matrix=a.invert(this._model_matrix)}generateSplitDistancesLUT(t){let e=r.vec3.dist(this.vertexAt(0),this.vertexAt(1));const n=[];for(let r=0;r<this._options.max_lod;r++){const i=this._options.max_edge_size/window.innerWidth;n[r]=e/Math.tan(i*t),e/=2}this._SPLIT_DIST_LUT=n}generateFaceCullingAnglesLUT(){let t=[];const e=Math.acos(this._options.radius/(this._options.radius+this._options.max_terrain_height));let n=Math.PI/3+e;for(let e=0;e<=this._options.max_lod;e++)t.push(Math.sin(n)),n/=2;this._FACE_CULLING_ANGLES=t}getSplitDistances(){if(void 0===this._SPLIT_DIST_LUT)throw new Error("call generateSplitDistanceLUT() before getSplitDistLUT()");return this._SPLIT_DIST_LUT}getFaceCullingAngle(t){return this._FACE_CULLING_ANGLES[t]}getVertexHash(t,e=5){return`${t[0].toFixed(e)}:${t[1].toFixed(e)}:${t[2].toFixed(e)}`}addVertex(t){const e=this.getVertexHash(t);if(this._vertex_index_map.has(e))return this._vertex_index_map.get(e);this._vertices.push(...t);const n=this._vertices.length/3-1;return this._vertex_index_map.set(e,n),n}vertexAt(t){return r.vec3.fromValues(this._vertices[3*t],this._vertices[3*t+1],this._vertices[3*t+2])}rotate(t,e){r.quat.setAxisAngle(this._options.orientation,t,e),this._needs_model_mat_update=!0}updateFrustum(){this._frustum.update(this._inv_model_matrix)}update(t){this._first_update&&(this._first_update=!1,this.init(t)),this._needs_model_mat_update&&(this._needs_model_mat_update=!1,this.computeModelMatrix());const e=[];for(const n of this._faces)n.updatePatchInstances(t,e);this._patch.pushInstance(...e),this._patch.bindInstances()}render(t,e){this._patch.render(t,e)}get shader(){return this._shader}get radius(){return this._options.radius}get center(){return this._options.center}get modelMatrix(){return this._model_matrix}get inverseModelMatrix(){return this._inv_model_matrix}get faces(){return this._faces}get faceCount(){return this._patch.instancesCount}get ID(){return this._ID}get options(){return this._options}get frustum(){return this._frustum}}u.count=0,e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),i=n(27),o=n(0),a=n(11),s=n(1),u=n(28);function c(t,e=a.colors.green){const n=new r.default(t,i.wireFrameShader);n.use();const o=n.getAttribLocation("position"),s=t.createVertexArray(),u=t.createBuffer();return t.bindVertexArray(s),t.bindBuffer(t.ARRAY_BUFFER,u),t.vertexAttribPointer(o,3,t.FLOAT,!1,12,0),t.enableVertexAttribArray(o),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),(r,...i)=>{const o=[];i.forEach(t=>{o.push(...t.from,...t.to)}),n.use(),t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array(o),t.STATIC_DRAW),n.setMat4("model_view_proj",r),n.setVec3("color",e),n.bindUniforms(),t.bindVertexArray(s),t.drawArrays(t.LINES,0,o.length/3),t.bindVertexArray(null),t.bindBuffer(t.ARRAY_BUFFER,null)}}function h(t){const e=[];for(let n=0;n<t.length;n+=2)e.push({from:t[n],to:t[(n+1)%t.length]});return e}function f(t,e=o.vec3.fromValues(1,0,0),n=o.vec3.fromValues(0,1,0),r=o.mat4.create()){const i=t.width/2,a=t.height/2;return{top_left:s.transform(s.sum(t.position,s.times(e,-i),s.times(n,a)),r),top_right:s.transform(s.sum(t.position,s.times(e,i),s.times(n,a)),r),bottom_right:s.transform(s.sum(t.position,s.times(e,i),s.times(n,-a)),r),bottom_left:s.transform(s.sum(t.position,s.times(e,-i),s.times(n,-a)),r)}}function l(t,e){return h([t.top_left,t.top_right,t.bottom_right,t.bottom_left,t.top_left,t.bottom_left,t.top_right,t.bottom_right,e.top_left,e.top_right,e.bottom_right,e.bottom_left,e.top_left,e.bottom_left,e.top_right,e.bottom_right,t.top_right,e.top_right,t.bottom_right,e.bottom_right,t.top_left,e.top_left,t.bottom_left,e.bottom_left])}function d(t){const e=t.depth/2;return l(f({position:s.sum(t.position,s.vec(0,0,e)),width:t.width,height:t.height}),f({position:s.sum(t.position,s.vec(0,0,-e)),width:t.width,height:t.height}))}e.createPointHelper=function(t,e=a.colors.red){const n=new r.default(t,u.pointShader);n.use();const i=n.getAttribLocation("position"),o=t.createVertexArray(),s=t.createBuffer();return t.bindVertexArray(o),t.bindBuffer(t.ARRAY_BUFFER,s),t.vertexAttribPointer(i,3,t.FLOAT,!1,12,0),t.enableVertexAttribArray(i),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),(r,...i)=>{const a=new Float32Array(3*i.length);i.forEach((t,e)=>{a[3*e]=t[0],a[3*e+1]=t[1],a[3*e+2]=t[2]}),n.use(),t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,a,t.STATIC_DRAW),n.setMat4("model_view_proj",r),n.setVec3("color",e),n.bindUniforms(),t.bindVertexArray(o),t.drawArrays(t.POINTS,0,a.length/3),t.bindVertexArray(null),t.bindBuffer(t.ARRAY_BUFFER,null)}},e.createLineHelper=c,e.createArrowHelper=function(t,e=a.colors.blue){const n=c(t,e);return(t,...e)=>{const r=[];for(const{origin:t,dir:n,length:i}of e){const e=s.sum(t,s.times(s.normalize(n),i));r.push({from:t,to:e})}n(t,...r)}},e.createLines=h,e.createRectangle=f,e.createSquareFrustum=l,e.createBox=d,e.createBoxHelper=function(t,e=a.colors.red){const n=c(t,e);return(t,...e)=>{const r=[];for(const t of e)r.push(...d(t));n(t,...r)}},e.createFrustumHelper=function(t){const e=c(t,a.colors.yellow),n=c(t,a.colors.red),r=c(t,a.colors.green);return(t,...i)=>{const o=[],a=[],s=[];for(const t of i){const e=t.getDebugLines();o.push(...e.slice(0,4)),a.push(...e.slice(4,8)),s.push(...e.slice(8,12))}e(t,...o),n(t,...a),r(t,...s)}},e.createPrismHelper=function(t,e=a.colors.cyan){const n=c(t,e);return(t,...e)=>{const r=[];for(const t of e)r.push(t.a1,t.b1,t.b1,t.c1,t.c1,t.a1,t.a1,t.a2,t.b1,t.b2,t.c1,t.c2,t.a2,t.b2,t.b2,t.c2,t.c2,t.a2);n(t,...h(r))}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0);function i(t){return r.vec3.fromValues((t>>16&255)/255,(t>>8&255)/255,(255&t)/255)}e.hex2vec3=i,e.colors={black:i(0),white:i(16777215),red:i(16711680),green:i(65280),blue:i(255),yellow:i(16776960),cyan:i(65535),pink:i(16711935),orange:i(16747520)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1);e.default=class{constructor(t,e,n=null){this._has_children=!1,this._sphere=e,this._parent=n,this._indices=t,this._level=null!==n?this._parent.level+1:0}intersectsFrustum(){return this._sphere.frustum.containsVolume(this.boundingGeometry.bottom_vertices)||this._sphere.frustum.containsVolume(this.boundingGeometry.top_vertices)}get boundingGeometry(){if(void 0===this._bounding_geometry){const t=this._sphere.options.max_terrain_height/this._sphere.radius,e=this._indices.map(t=>i.normalize(this._sphere.vertexAt(t))),n=e.map(e=>i.sum(e,i.times(i.normalize(e),t)));this._bounding_geometry={bottom_vertices:e,top_vertices:n}}return this._bounding_geometry}isVisible(t){const e=i.normalize(this.centroid),n=i.normalize(i.sub(e,t));return!!(r.vec3.dot(e,n)<this._sphere.getFaceCullingAngle(this._level))&&this.intersectsFrustum()}getMidPoint(t,e){const n=this._sphere.vertexAt(t),r=this._sphere.vertexAt(e),o=i.lerp(n,r,.5);return this._sphere.addVertex(o)}shouldSplit(t){return!(this._level>=this._sphere.options.max_lod)&&r.vec3.dist(t,this.centroid)<this._sphere.getSplitDistances()[this._level]}mapToUnitSphere(t){return i.normalize(t)}get centroid(){return void 0===this._centroid&&(this._centroid=this.mapToUnitSphere(i.centroid(...this._indices.map(t=>this._sphere.vertexAt(t))))),this._centroid}get patchInstance(){if(void 0===this._patch_instance){const[t,e,n]=this._indices.slice(0,3).map(t=>this._sphere.vertexAt(t)),r=i.sub(e,t),o=i.sub(n,t);this._patch_instance={level:this._level,A:t,R:r,S:o}}return this._patch_instance}updatePatchInstances(t,e){const n=i.transform(t.position,this._sphere.inverseModelMatrix);if(this.isVisible(n))if(this.shouldSplit(n)){this.split();for(let n of this._children)n.updatePatchInstances(t,e)}else e.push(this.patchInstance)}get level(){return this._level}get children(){return this._children}get hasChildren(){return this._has_children}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),i=n(1);e.default=class{constructor(t,e){this.gl=t,this._sphere=e,this._levels=e.options.patch_levels,this._instances=[]}initUniforms(){const t=i.vec(-14e3,8e3,-17e3);this._sphere.shader.setFloat("morph_range",this._sphere.options.morph_range),this._sphere.shader.setVec3("light_pos",t),this._sphere.shader.setArray("distanceLUT",this._sphere.getSplitDistances(),r.UniformType.FLOAT)}initAttributes(){this.attributes={pos:this._sphere.shader.getAttribLocation("pos"),morph:this._sphere.shader.getAttribLocation("morph"),level:this._sphere.shader.getAttribLocation("level"),A:this._sphere.shader.getAttribLocation("A"),R:this._sphere.shader.getAttribLocation("R"),S:this._sphere.shader.getAttribLocation("S")}}initBuffers(){this.VAO=this.gl.createVertexArray(),this.VBO=this.gl.createBuffer(),this.EBO=this.gl.createBuffer(),this.VBO_instance=this.gl.createBuffer(),this.gl.bindVertexArray(this.VAO),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VBO),this.gl.enableVertexAttribArray(this.attributes.pos),this.gl.enableVertexAttribArray(this.attributes.morph),this.gl.vertexAttribPointer(this.attributes.pos,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.attributes.morph,2,this.gl.FLOAT,!1,16,8)}init(){this._sphere.shader.use(),this.initUniforms(),this.initAttributes(),this.initBuffers(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VBO_instance),this.gl.enableVertexAttribArray(this.attributes.level),this.gl.enableVertexAttribArray(this.attributes.A),this.gl.enableVertexAttribArray(this.attributes.R),this.gl.enableVertexAttribArray(this.attributes.S),this.gl.vertexAttribPointer(this.attributes.level,1,this.gl.FLOAT,!1,40,0),this.gl.vertexAttribPointer(this.attributes.A,3,this.gl.FLOAT,!1,40,4),this.gl.vertexAttribPointer(this.attributes.R,3,this.gl.FLOAT,!1,40,16),this.gl.vertexAttribPointer(this.attributes.S,3,this.gl.FLOAT,!1,40,28),this.gl.vertexAttribDivisor(this.attributes.level,1),this.gl.vertexAttribDivisor(this.attributes.A,1),this.gl.vertexAttribDivisor(this.attributes.R,1),this.gl.vertexAttribDivisor(this.attributes.S,1),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.EBO),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindVertexArray(null),this.generateGeometry()}rebind(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VBO),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this._vertices),this.gl.DYNAMIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.EBO),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint32Array(this._indices),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}bindInstances(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VBO_instance),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this._instances),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}pushInstance(...t){for(const e of t)this._instances.push(e.level,...e.A,...e.R,...e.S)}updateUniforms(t,e){const n=i.transform(t.position,this._sphere.inverseModelMatrix);this._sphere.shader.setMat4("model",this._sphere.modelMatrix),this._sphere.shader.setMat4("view",t.viewMatrix),this._sphere.shader.setMat4("projection",t.projectionMatrix),this._sphere.shader.setVec3("cam_pos",n),this._sphere.shader.setBool("points",e),this._sphere.shader.bindUniforms()}render(t,e=this.gl.TRIANGLES){this._sphere.shader.use(),this.updateUniforms(t,e!==this.gl.TRIANGLES),this.gl.bindVertexArray(this.VAO),this._instances_count=this._instances.length/10,this.gl.drawElementsInstanced(e,this._indices.length,this.gl.UNSIGNED_INT,0,this._instances_count),this.gl.bindVertexArray(null),this._instances=[]}get instancesCount(){return this._instances_count}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),i=n(37),o=n(38),a=n(39),s=n(40),u=n(41);!function(t){let e=1;t.generate=function(t,n,i,o,a=!0){n instanceof r.default||(n=new r.default(t,n)),n.compile();const s=t.createVertexArray(),u=t.createBuffer();t.bindVertexArray(s),t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),t.STATIC_DRAW);const c=n.getAttribLocation("position");t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(c),t.bindBuffer(t.ARRAY_BUFFER,null);const h=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,h),this.texture=t.createTexture();const f=e++;return t.activeTexture(t.TEXTURE0+f),t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGB,i,o,0,t.RGB,t.UNSIGNED_BYTE,null),a&&(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.generateMipmap(t.TEXTURE_2D)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE&&console.error("ERROR::FRAMEBUFFER:: Framebuffer is not complete"),t.disable(t.DEPTH_TEST),t.viewport(0,0,i,o),t.clearColor(0,1,.5,1),t.clear(t.COLOR_BUFFER_BIT),n.use(),n.bindUniforms(),t.bindVertexArray(s),t.drawArrays(t.TRIANGLES,0,6),t.deleteVertexArray(s),t.deleteBuffer(u),t.bindFramebuffer(t.FRAMEBUFFER,null),t.enable(t.DEPTH_TEST),{handle:this.texture,bound_to:f,width:i,height:o}},t.remove=function(t,e){t.deleteTexture(e.handle)},t.bind=function(t,e,n){t.bindTexture(t.TEXTURE0+n,e.handle),e.bound_to=n},t.toCanvas=function(t,e,n){const i=document.createElement("canvas"),o=i.getContext("webgl2"),a=t instanceof r.default?t:new r.default(o,t);i.width=e,i.height=n,a.use();const s=a.getAttribLocation("position"),u=o.createBuffer();return o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),o.STATIC_DRAW),o.enableVertexAttribArray(s),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.viewport(0,0,e,n),o.drawArrays(o.TRIANGLES,0,6),o.deleteBuffer(u),i},t.toURL=function(e,n,r){return new Promise(i=>{t.toCanvas(e,n,r).toBlob(t=>{i(URL.createObjectURL(t))})})},t.getImage=function(e,n,r){return new Promise(i=>{t.toURL(e,n,r).then(t=>{const e=new Image;e.onload=(()=>{URL.revokeObjectURL(t),i(e)}),e.src=t})})},t.openInWindow=function(e,n,r,i="Texture Visualizer"){t.toURL(e,n,r).then(t=>{window.open(t,i,`menubar=no,\n                location=no,\n                resizable=yes,\n                scrollbars=no,\n                status=no,\n                width=${n},\n                height=${r}\n            `),window.setTimeout(()=>{URL.revokeObjectURL(t)},500)})},t.generatePlainColorTexture=function(e,n,i,o,s=!0){const u=new r.default(e,a.plainColorShader);return u.setVec3("color",o),t.generate(e,u,n,i,s)},t.generateHeightMap=function(e,n,o,a=1e4*Math.random(),s=8,u=2,c=!0){const h=new r.default(e,i.heightMapShader);return h.defineFloat("SEED",a),h.defineFloat("FREQUENCY",u),h.defineInt("OCTAVES",s),t.generate(e,h,n,o,c)},t.generateClampedHeightMap=function(e,n,i,o,a=1e4*Math.random(),s=8,c=2,h=!0){const f=new r.default(e,u.clampedHeightMapShader);return f.defineFloat("SEED",a),f.defineFloat("FREQUENCY",c),f.defineInt("OCTAVES",s),f.setFloat("clamp_height",o),t.generate(e,f,n,i,h)},t.generateColorMap=function(e,n,i=!0){const o=new r.default(e,s.heightMapToColorMapShader);return o.registerTexture("height_map",n.bound_to),t.generate(e,o,n.width,n.height,i)},t.generateNormalMap=function(e,n,i=!0){const a=new r.default(e,o.normalMapShader);return a.registerTexture("height_map",n.bound_to),t.generate(e,a,n.width,n.height,i)}}(e.Texture||(e.Texture={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(6);e.simplex_noise3D=((t="snoise3")=>r.preprocessor_isolate(t,`\n    //\tSimplex 3D Noise \n    //\tby Ian McEwan, Ashima Arts\n    //\n    ${((t="permute_vec4")=>r.preprocessor_isolate(t,`vec4 ${t}(vec4 x){return mod(((x * 34.0) + 1.0) * x, 289.0);}`))("permute")}\n    ${((t="taylorInvSqrt_vec4")=>r.preprocessor_isolate(t,`vec4 ${t}(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}`))("taylorInvSqrt")}\n\n    float ${t}(vec3 v){ \n      const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n      const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n    \n    // First corner\n      vec3 i  = floor(v + dot(v, C.yyy) );\n      vec3 x0 =   v - i + dot(i, C.xxx) ;\n    \n    // Other corners\n      vec3 g = step(x0.yzx, x0.xyz);\n      vec3 l = 1.0 - g;\n      vec3 i1 = min( g.xyz, l.zxy );\n      vec3 i2 = max( g.xyz, l.zxy );\n    \n      //  x0 = x0 - 0. + 0.0 * C \n      vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n      vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n      vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n    \n    // Permutations\n      i = mod(i, 289.0 ); \n      vec4 p = permute( permute( permute( \n                 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n               + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n               + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n    \n    // Gradients\n    // ( N*N points uniformly over a square, mapped onto an octahedron.)\n      float n_ = 1.0/7.0; // N=7\n      vec3  ns = n_ * D.wyz - D.xzx;\n    \n      vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n    \n      vec4 x_ = floor(j * ns.z);\n      vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n    \n      vec4 x = x_ *ns.x + ns.yyyy;\n      vec4 y = y_ *ns.x + ns.yyyy;\n      vec4 h = 1.0 - abs(x) - abs(y);\n    \n      vec4 b0 = vec4( x.xy, y.xy );\n      vec4 b1 = vec4( x.zw, y.zw );\n    \n      vec4 s0 = floor(b0)*2.0 + 1.0;\n      vec4 s1 = floor(b1)*2.0 + 1.0;\n      vec4 sh = -step(h, vec4(0.0));\n    \n      vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n      vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n    \n      vec3 p0 = vec3(a0.xy,h.x);\n      vec3 p1 = vec3(a0.zw,h.y);\n      vec3 p2 = vec3(a1.xy,h.z);\n      vec3 p3 = vec3(a1.zw,h.w);\n    \n    //Normalise gradients\n      vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n      p0 *= norm.x;\n      p1 *= norm.y;\n      p2 *= norm.z;\n      p3 *= norm.w;\n    \n    // Mix final noise value\n      vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n      m = m * m;\n      return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n                                    dot(p2,x2), dot(p3,x3) ) );\n    }`)),e.simplex_noise4D=((t="snoise4")=>r.preprocessor_isolate(t,"\n    //\tSimplex 4D Noise \n    //\tby Ian McEwan, Ashima Arts\n    //\n    vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\n    float permute(float x){return floor(mod(((x*34.0)+1.0)*x, 289.0));}\n    vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\n    float taylorInvSqrt(float r){return 1.79284291400159 - 0.85373472095314 * r;}\n    \n    vec4 grad4(float j, vec4 ip){\n      const vec4 ones = vec4(1.0, 1.0, 1.0, -1.0);\n      vec4 p,s;\n    \n      p.xyz = floor( fract (vec3(j) * ip.xyz) * 7.0) * ip.z - 1.0;\n      p.w = 1.5 - dot(abs(p.xyz), ones.xyz);\n      s = vec4(lessThan(p, vec4(0.0)));\n      p.xyz = p.xyz + (s.xyz*2.0 - 1.0) * s.www; \n    \n      return p;\n    }\n    \n    float snoise(vec4 v){\n      const vec2  C = vec2( 0.138196601125010504,  // (5 - sqrt(5))/20  G4\n                            0.309016994374947451); // (sqrt(5) - 1)/4   F4\n    // First corner\n      vec4 i  = floor(v + dot(v, C.yyyy) );\n      vec4 x0 = v -   i + dot(i, C.xxxx);\n    \n    // Other corners\n    \n    // Rank sorting originally contributed by Bill Licea-Kane, AMD (formerly ATI)\n      vec4 i0;\n    \n      vec3 isX = step( x0.yzw, x0.xxx );\n      vec3 isYZ = step( x0.zww, x0.yyz );\n    //  i0.x = dot( isX, vec3( 1.0 ) );\n      i0.x = isX.x + isX.y + isX.z;\n      i0.yzw = 1.0 - isX;\n    \n    //  i0.y += dot( isYZ.xy, vec2( 1.0 ) );\n      i0.y += isYZ.x + isYZ.y;\n      i0.zw += 1.0 - isYZ.xy;\n    \n      i0.z += isYZ.z;\n      i0.w += 1.0 - isYZ.z;\n    \n      // i0 now contains the unique values 0,1,2,3 in each channel\n      vec4 i3 = clamp( i0, 0.0, 1.0 );\n      vec4 i2 = clamp( i0-1.0, 0.0, 1.0 );\n      vec4 i1 = clamp( i0-2.0, 0.0, 1.0 );\n    \n      //  x0 = x0 - 0.0 + 0.0 * C \n      vec4 x1 = x0 - i1 + 1.0 * C.xxxx;\n      vec4 x2 = x0 - i2 + 2.0 * C.xxxx;\n      vec4 x3 = x0 - i3 + 3.0 * C.xxxx;\n      vec4 x4 = x0 - 1.0 + 4.0 * C.xxxx;\n    \n    // Permutations\n      i = mod(i, 289.0); \n      float j0 = permute( permute( permute( permute(i.w) + i.z) + i.y) + i.x);\n      vec4 j1 = permute( permute( permute( permute (\n                i.w + vec4(i1.w, i2.w, i3.w, 1.0 ))\n              + i.z + vec4(i1.z, i2.z, i3.z, 1.0 ))\n              + i.y + vec4(i1.y, i2.y, i3.y, 1.0 ))\n              + i.x + vec4(i1.x, i2.x, i3.x, 1.0 ));\n    // Gradients\n    // ( 7*7*6 points uniformly over a cube, mapped onto a 4-octahedron.)\n    // 7*7*6 = 294, which is close to the ring size 17*17 = 289.\n    \n      vec4 ip = vec4(1.0/294.0, 1.0/49.0, 1.0/7.0, 0.0) ;\n    \n      vec4 p0 = grad4(j0,   ip);\n      vec4 p1 = grad4(j1.x, ip);\n      vec4 p2 = grad4(j1.y, ip);\n      vec4 p3 = grad4(j1.z, ip);\n      vec4 p4 = grad4(j1.w, ip);\n    \n    // Normalise gradients\n      vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n      p0 *= norm.x;\n      p1 *= norm.y;\n      p2 *= norm.z;\n      p3 *= norm.w;\n      p4 *= taylorInvSqrt(dot(p4,p4));\n    \n    // Mix contributions from the five corners\n      vec3 m0 = max(0.6 - vec3(dot(x0,x0), dot(x1,x1), dot(x2,x2)), 0.0);\n      vec2 m1 = max(0.6 - vec2(dot(x3,x3), dot(x4,x4)            ), 0.0);\n      m0 = m0 * m0;\n      m1 = m1 * m1;\n      return 49.0 * ( dot(m0*m0, vec3( dot( p0, x0 ), dot( p1, x1 ), dot( p2, x2 )))\n                  + dot(m1*m1, vec2( dot( p3, x3 ), dot( p4, x4 ) ) ) ) ;\n    \n    }\n  "))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(2),o=n(42),a=n(1),s=n(4);e.createTextureHelper=function(t){const e=new i.default(t,o.textShader);e.use();const n=t.createVertexArray();t.bindVertexArray(n);const u=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,u),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),t.STATIC_DRAW);const c=e.getAttribLocation("position");t.vertexAttribPointer(c,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(c);const h=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,h),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),t.STATIC_DRAW);const f=e.getAttribLocation("texcoords");return t.vertexAttribPointer(f,2,t.FLOAT,!0,0,0),t.enableVertexAttribArray(f),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),(i,o,u)=>{u||(u=s.g_vec(i.width,i.height));const c=r.mat4.create();r.mat4.translate(c,c,a.div(a.vec(o[0],t.canvas.height-u[1]-o[1],0),a.vec(t.canvas.width,t.canvas.height,1))),r.mat4.scale(c,c,[u[0]/t.canvas.width,u[1]/t.canvas.height,1]),e.use(),t.bindTexture(t.TEXTURE_2D,i.handle),e.registerTexture("u_texture",i.bound_to),e.setMat4("transfo",c),e.bindUniforms(),t.bindVertexArray(n),t.drawArrays(t.TRIANGLES,0,6),t.bindVertexArray(null),t.bindBuffer(t.ARRAY_BUFFER,null)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(7),o=n(19),a=n(23),s=n(35),u=n(36),c=n(11),h=n(10),f=n(3),l=n(14),d=n(16),_=n(43),p=n(1),v=n(4),m=n(45);class g{constructor(t){this.gl=t,this.mode=0,this.culling=!0,this.needs_redraw=!0,this.update_on_move=!0,this.render_text=!0,this.show_height_map=!1,this.show_normal_map=!1,this.show_bounding_box=!1,this.show_frustum=!1,this.show_specular=!1,this.flat_shaded=!0,this.fps_history=[],this.clock=new u.default,this.universe=new s.default;const e=new a.default(t,{sphere_options:{center:p.vec(0,0,0),radius:6371,max_lod:5,patch_levels:3,max_edge_size:100,max_terrain_height:400},textures:m.generateEarthyTextures(t,2048),flat_shaded:this.flat_shaded,sphere_type:a.SphereType.IcoSphere}),n=new a.default(t,{sphere_options:{radius:1737,max_lod:5,patch_levels:2,max_edge_size:50,max_terrain_height:10.786,center:p.vec(-38440,0,0)},textures:m.generateMoonyTextures(t,2048),flat_shaded:this.flat_shaded,sphere_type:a.SphereType.QuadSphere});this.universe.add(e,n),this._player=new o.default({position:p.vec(0,0,3*-e.radius)}),i.default.instance.onKeyDown(t=>this.onKeyDown.call(this,t)),window.addEventListener("resize",()=>{this.onResize.call(this,window.innerWidth,window.innerHeight)}),this.setCulling(this.culling),this.drawFrustum=h.createFrustumHelper(t),this.drawBoundingBox=h.createBoxHelper(t,c.colors.orange),this.drawTexture=d.createTextureHelper(t);this.drawText=_.createTextHelper(t,{color:"#0abde3",font_size:20,font_family:"monospace, sans-serif",background_color:"rgba(0, 0, 0, 0)"}),this.drawPlot=_.createPlotHelper(t,{width:150,height:70,auto_scale:!1,normalized:!0,background_color:"rgba(0, 0, 0, 0)",color:"#0abde3"}),this.setBlending()}setBlending(t=!0){t?(this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)):this.gl.disable(this.gl.BLEND)}start(){this.update(),requestAnimationFrame(()=>{this.start.call(this)})}setCulling(t=!0){this.culling=t,this.culling?(this.gl.enable(this.gl.CULL_FACE),this.gl.frontFace(this.gl.CW)):this.gl.disable(this.gl.CULL_FACE)}onKeyDown(t){switch(t.key.toLocaleLowerCase()){case"m":this.mode=(this.mode+1)%g.DRAWING_MODES.length,this.needs_redraw=!0;break;case"b":this.show_bounding_box=!this.show_bounding_box,this.needs_redraw=!0;break;case"c":this.setCulling(!this.culling),this.needs_redraw=!0;break;case"f":this.flat_shaded=!this.flat_shaded;for(const t of this.universe.planets)void 0===t.options.textures.normal_map&&(t.options.textures.normal_map=l.Texture.generateNormalMap(this.gl,t.options.textures.height_map),t.shader.registerTexture("normal_map",t.options.textures.normal_map.bound_to)),t.shader.define(this.flat_shaded?"FLAT_SHADING":"SMOOTH_SHADING"),t.shader.undefine(this.flat_shaded?"SMOOTH_SHADING":"FLAT_SHADING");this.needs_redraw=!0;break;case"u":this.update_on_move=!this.update_on_move,this.needs_redraw=!0;break;case"t":this.render_text=!this.render_text,this.needs_redraw=!0;break;case"h":for(const t of this.universe.planets)t.options.textures.height_map&&(this.show_height_map=!this.show_height_map,this.show_normal_map=!this.show_height_map,t.shader.setBool("show_normal_map",this.show_normal_map),t.shader.setBool("show_height_map",this.show_height_map),this.needs_redraw=!0);break;case"n":for(const t of this.universe.planets)t.options.textures.normal_map&&(this.show_normal_map=!this.show_normal_map,this.show_height_map=!this.show_normal_map,t.shader.setBool("show_height_map",this.show_height_map),t.shader.setBool("show_normal_map",this.show_normal_map),this.needs_redraw=!0);break;case"p":for(const t of this.universe.planets)this.show_specular=!this.show_specular,this.show_specular?t.shader.define("SPECULAR"):t.shader.undefine("SPECULAR");this.needs_redraw=!0}}onResize(t,e){this._player.camera.aspectRatio=t/e;for(const t of this.universe.planets)t.sphere.updateLookUpTables(this._player.camera);this.needs_redraw=!0}clearGL(){this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}updateFPS(t){this.fps_history.length>=60&&this.fps_history.splice(0,this.fps_history.length-60+1),this.fps_history.push(t)}update(){const t=this.clock.getDelta(),e=f.minimize(this.universe.planets,t=>r.vec3.dist(t.center,this._player.position)),n=f.getNormalizedAltitude(this._player.position,e.center,e.radius);return this.needs_redraw=this._player.update(t,n)||!this.update_on_move||this.needs_redraw,this.needs_redraw?(this.needs_redraw=!1,this.universe.update(this._player.camera),this.updateFPS(t),this.clearGL(),this.render(),!0):this.needs_redraw=!1}render(){this.universe.render(this._player.camera,g.DRAWING_MODES[this.mode]),this.renderText();for(const t of this.universe.planets){const e=f.combineMatrices(this._player.camera.projectionMatrix,this._player.camera.viewMatrix,t.sphere.modelMatrix);this.show_frustum&&this.drawFrustum(e,t.sphere.frustum),this.show_bounding_box&&this.drawBoundingBox(e,{position:p.fill(0),width:2,height:2,depth:2})}}renderText(){if(this.setBlending(this.render_text),this.render_text){const t=f.minimize(this.universe.planets,t=>r.vec3.dist(t.center,this._player.position)),e=this.drawText(`patches: ${f.total(...this.universe.planets.map(t=>t.sphere.faceCount))}`,v.g_vec(0,0)),n=(1e3/f.average(...this.fps_history)).toPrecision(2),i=(1e3/Math.max(...this.fps_history)).toPrecision(2),o=f.formatDistance(1e3*f.getAltitude(this._player.position,t.sphere.center,t.sphere.radius));this.drawText(`alt: ${o}`,v.g_vec(0,e.height)),this.drawText(`avg fps: ${n}`,v.g_vec(0,2*e.height)),this.drawText(`min fps: ${i}`,v.g_vec(0,3*e.height));const a=this.fps_history.map((t,e)=>v.g_vec(e/this.fps_history.length,t/60));this.drawPlot(v.g_vec(0,4*e.height),...a)}}}g.DRAWING_MODES=[WebGL2RenderingContext.TRIANGLES,WebGL2RenderingContext.POINTS,WebGL2RenderingContext.LINES],e.default=g,window.Main=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.event_handlers=new Map}on(t,e){this.isListening(t)||this.event_handlers.set(t,[]),this.event_handlers.get(t).push(e)}isListening(t){return this.event_handlers.has(t)}emit(t,e,n){if(this.isListening(t))for(const r of this.event_handlers.get(t))r.call(n,e)}bindEvent(t,e){t.on(e,t=>this.emit(e,t))}removeListener(t){this.event_handlers.delete(t)}removeListeners(){this.event_handlers.clear()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(3),o=n(1),a=n(20),s=n(21);var u;!function(t){t[t.MOUSE_KEYBOARD=0]="MOUSE_KEYBOARD"}(u=e.PlayerControls||(e.PlayerControls={}));e.default=class{constructor(t,e=document){this._options=Object.assign({position:o.fill(0),orientation:r.quat.create(),FOV:i.radians(45),max_view_distance:299792458,min_view_distance:.1,controls:u.MOUSE_KEYBOARD},t),this._camera=new a.default(this._options.position,this._options.FOV,window.innerWidth/window.innerHeight,this._options.min_view_distance,this._options.max_view_distance),this._camera.orientation=this._options.orientation,this.initController(e)}initController(t){switch(this._options.controls){case u.MOUSE_KEYBOARD:default:this._controller=new s.default(this._camera,t)}}update(t,e=1){return this._controller.update(t,e)}get camera(){return this._camera}get position(){return this._camera.position}get FOV(){return this._camera.FOV}get controller(){return this._controller}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1);e.default=class{constructor(t,e,n,i,o){this._position=t,this._FOV=e,this._near=i,this._far=o,this._aspect=n,this._proj_matrix=r.mat4.create(),this._view_matrix=r.mat4.create(),this.updateProjectionMatrix(),this._basis={up:r.vec3.fromValues(0,1,0),right:r.vec3.fromValues(1,0,0),front:r.vec3.fromValues(0,0,1)},this._orientation=r.quat.create()}updateProjectionMatrix(){r.mat4.perspective(this._proj_matrix,this._FOV,this._aspect,this._near,this._far)}move(t){r.vec3.add(this._position,this._position,t)}updateViewMatrix(){this.lookAt(i.sum(this._position,this._basis.front))}lookAt(t){r.mat4.lookAt(this._view_matrix,this._position,t,this._basis.up)}get projectionMatrix(){return this._proj_matrix}get viewMatrix(){return this._view_matrix}get position(){return this._position}get FOV(){return this._FOV}set FOV(t){this._FOV=t,this.updateProjectionMatrix()}get aspectRatio(){return this._aspect}set aspectRatio(t){this._aspect=t,this.updateProjectionMatrix()}get near(){return this._near}get far(){return this._far}get front(){return this._basis.front}get orientation(){return this._orientation}set orientation(t){this._orientation.set(t),this.updateBasis()}updateBasis(){this._basis.front=i.rotate([0,0,1],this._orientation),this._basis.right=i.rotate([1,0,0],this._orientation),this._basis.up=i.cross(this._basis.front,this._basis.right)}get basis(){return this._basis}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(3),o=n(1),a=n(7),s=n(22);e.default=class{constructor(t,e,n=1e4,r=.1){if(this._layout=s.KeyboardLayout.CLASSICAL,this._needs_update=!0,this._pointerLockEnabled=!1,this.camera=t,this.domElement=e,this._speed_kps=n,this._mouse_sensitivity=r,!s.KeyboardLayoutMaps.has(this._layout))throw new Error(`No Key mapping for '${s.KeyboardLayout[this._layout]}' defined in 'KeyboardLayoutMaps'`);this._key_map=s.KeyboardLayoutMaps.get(this._layout),this._actions=new Map,a.default.instance.onKeyDown(this.onKeyDown.bind(this)),a.default.instance.onKeyUp(this.onKeyUp.bind(this)),a.default.instance.onMouseMove(this.onMouseMove.bind(this)),a.default.instance.onPointerLockChange(this.onPointerLockChange.bind(this)),a.default.instance.onPointerLockError(this.onPointerLockError.bind(this))}actionPerformed(t,e){return this._key_map[t].some(t=>t===e)}updateActions(t,e){for(let n in this._key_map)this.actionPerformed(n,t)&&this._actions.set(n,e)}onKeyDown(t){this.updateActions(t.code,!0)}onKeyUp(t){this.updateActions(t.code,!1)}onPointerLockChange(t){this._pointerLockEnabled=!this._pointerLockEnabled}onPointerLockError(t){console.error("Pointer Lock Error")}onMouseMove(t){if(!this._pointerLockEnabled)return;const e=i.radians(t.movementX*this._mouse_sensitivity),n=i.radians(t.movementY*this._mouse_sensitivity),o=this.camera.orientation;r.quat.rotateX(o,o,n),r.quat.rotateY(o,o,-e),this.camera.orientation=o,this._needs_update=!0}update(t,e){const n=t/1e3*this._speed_kps*e,i=this.camera.basis;let a=r.vec3.create(),s=!1;this._actions.get("forward")&&(r.vec3.add(a,a,i.front),s=!0),this._actions.get("backward")&&(r.vec3.sub(a,a,i.front),s=!0),this._actions.get("right")&&(r.vec3.sub(a,a,i.right),s=!0),this._actions.get("left")&&(r.vec3.add(a,a,i.right),s=!0),this._actions.get("up")&&(r.vec3.add(a,a,i.up),s=!0),this._actions.get("down")&&(r.vec3.sub(a,a,i.up),s=!0),this.camera.move(o.scale(o.normalize(a),n)),this.camera.updateViewMatrix();const u=s||this._needs_update;return this._needs_update=!1,u}}},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.CLASSICAL=0]="CLASSICAL"}(r=e.KeyboardLayout||(e.KeyboardLayout={})),e.KeyboardLayoutMaps=new Map,e.KeyboardLayoutMaps.set(r.CLASSICAL,{forward:["KeyW","ArrowUp"],backward:["KeyS","ArrowDown"],left:["KeyA","ArrowLeft"],right:["KeyD","ArrowRight"],up:["Space"],down:["ShiftLeft","ShiftRight"]})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(2),i=n(24),o=n(25),a=n(32);var s;!function(t){t[t.IcoSphere=0]="IcoSphere",t[t.QuadSphere=1]="QuadSphere"}(s=e.SphereType||(e.SphereType={}));e.default=class{constructor(t,e={},n){this.gl=t,this._options=Object.assign({sphere_options:{},textures:{},sphere_type:s.IcoSphere,flat_shaded:!1},e),this.initShader(n),this.initSphere(),this.initTextures()}initTextures(){if(void 0!==this._options.textures.height_map&&(this._shader.registerTexture("height_map",this._options.textures.height_map.bound_to),this._shader.define("HEIGHT_MAP")),void 0!==this._options.textures.normal_map)this._shader.registerTexture("normal_map",this._options.textures.normal_map.bound_to),this._shader.define("NORMAL_MAP");else if(!this._options.flat_shaded)throw new Error("Cannot render a planet using smooth shading without a normal map");void 0!==this._options.textures.color_map&&(this._shader.registerTexture("color_map",this._options.textures.color_map.bound_to),this._shader.define("COLOR_MAP")),this._shader.defineFloat("RADIUS",this._options.sphere_options.radius),this._shader.defineFloat("MAX_HEIGHT",this._options.sphere_options.max_terrain_height)}initShader(t){switch(this._shader=t instanceof r.default?t:new r.default(this.gl,i.planetShader),this._options.sphere_type){case s.QuadSphere:this._shader.define("QUAD_SPHERE");break;case s.IcoSphere:default:this._shader.define("ICO_SPHERE")}this._shader.define(this._options.flat_shaded?"FLAT_SHADING":"SMOOTH_SHADING")}initSphere(){switch(this._options.sphere_type){case s.QuadSphere:this._sphere=new a.default(this.gl,this._options.sphere_options,this._shader);break;case s.IcoSphere:default:this._sphere=new o.default(this.gl,this._options.sphere_options,this._shader)}this._options.sphere_options=this.sphere.options}update(t){this._sphere.update(t)}render(t,e){this._sphere.render(t,e)}get ID(){return this._sphere.ID}get sphere(){return this._sphere}get radius(){return this._options.sphere_options.radius}get center(){return this._options.sphere_options.center}get options(){return this._options}get shader(){return this._shader}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(5),i=n(8);e.planetShader={vertex:`\nprecision mediump float;\n\nin vec2 pos;\nin vec2 morph;\n\nin float level;\nin vec3 A;\nin vec3 R;\nin vec3 S;\n\nuniform mat4 model;\nuniform mat4 view;\nuniform mat4 projection;\n\n#ifdef HEIGHT_MAP\n    uniform sampler2D height_map;\n#endif\n\nuniform vec3 cam_pos;\nuniform float morph_range;\nuniform float distanceLUT[15];\nuniform bool points;\n\nout vec3 frag_pos;\nflat out int v_level;\nout vec3 v_cam_pos;\n\nfloat getHeight(vec3 pos) {\n    #ifdef HEIGHT_MAP\n        vec2 uv = vec2(atan(pos.z, pos.x), acos(pos.y)) / vec2(6.28318530718f, 3.14159265359f);\n        return texture(height_map, uv).r * (MAX_HEIGHT / RADIUS);\n    #endif\n\n    return 0.0f;\n}\n\n// http://mathproofs.blogspot.com/2005/07/mapping-cube-to-sphere.html\nvec3 mapToUnitSphere(vec3 u) {\n    \n    #ifdef QUAD_SPHERE\n        float x2 = pow(u.x, 2.0f);\n        float y2 = pow(u.y, 2.0f);\n        float z2 = pow(u.z, 2.0f);\n\n        return vec3(\n            u.x * sqrt(1.0f - (y2 * 0.5f) - (z2 * 0.5f) + ((y2 * z2) / 3.0f)),\n            u.y * sqrt(1.0f - (z2 * 0.5f) - (x2 * 0.5f) + ((z2 * x2) / 3.0f)),\n            u.z * sqrt(1.0f - (x2 * 0.5f) - (y2 * 0.5f) + ((x2 * y2) / 3.0f))\n        );\n    #else\n        return normalize(u);\n    #endif\n}\n\n${r.getPatchPosition()}\n\nvoid main() {\n    v_level = int(level);\n    v_cam_pos = cam_pos;\n\n    vec3 tri_pos = getPatchPosition(A, R, S, pos, morph, cam_pos, v_level, morph_range);\n    \n    vec3 N = mapToUnitSphere(tri_pos);\n    tri_pos = N * (1.0 + getHeight(N));\n\n    frag_pos = (model * vec4(tri_pos, 0.0)).xyz;\n\n    gl_Position = projection * view * model * vec4(tri_pos, 1.0);\n\n    if (points) {\n        gl_PointSize = 2.0f;\n    }\n}\n`,fragment:`\nprecision mediump float;\n\nin vec3 frag_pos;\nin vec3 v_cam_pos;\nflat in int v_level;\n\nuniform bool points;\nuniform vec3 light_pos;\n\n#ifdef HEIGHT_MAP\n    uniform sampler2D height_map;\n    uniform bool show_height_map;\n#endif\n\n#ifdef SMOOTH_SHADING\n    uniform sampler2D normal_map;\n    uniform bool show_normal_map;\n#endif\n\n#ifdef COLOR_MAP\n    uniform sampler2D color_map;\n#endif\n\nuniform float seed;\n\nuniform mat4 model;\n\nout vec4 frag_color;\n\n#ifdef FLAT_SHADING\n    ${r.getFaceNormal()}\n#endif\n\nvec3 getNormal(const vec2 uv) {\n    #ifdef SMOOTH_SHADING\n        vec3 N = normalize(texture(normal_map, uv).rgb * 2.0f - 1.0f);\n        vec3 norm = normalize(frag_pos);\n        vec3 up = vec3(0, 1, 0) - norm;\n        vec3 T = normalize(cross(norm, up));\n        vec3 B = normalize(cross(norm, T));\n        mat3 TBN = mat3(T, B, norm);\n        return normalize(TBN * normalize(N));\n    #else // flat shading\n        return getFaceNormal(frag_pos);\n    #endif\n}\n\nvec3 getLighting(const vec2 uv) {\n\n    float intensity = 0.0f;\n\n    vec3 normal = getNormal(uv);\n\n    // point light :\n    vec3 light_dir = normalize(light_pos - normalize(frag_pos));\n\n    float diffuse = clamp(dot(light_dir, normal), 0.0f, 1.0f);\n    intensity += diffuse;\n\n    #ifdef SPECULAR\n        vec3 view_dir = normalize(v_cam_pos - frag_pos);\n        vec3 reflect_dir = reflect(light_dir, normal);\n\n        float spec_intensity = 0.0f;\n\n        if (texture(height_map, uv).r == 0.0f) {\n            spec_intensity = 0.5f;\n        }\n\n        float specular = pow(max(dot(view_dir, reflect_dir), 0.0f), 128.0f) * spec_intensity;\n        intensity += specular;\n    #endif\n\n    return vec3(intensity);\n}\n\n${r.getLevelColor()}\n\n#ifndef COLOR_MAP\n    ${i.getTerrainColor()}\n#endif\n\nvoid main() {\n\n    if (points) {\n        frag_color = vec4(getLevelColor(v_level), 1.0);\n        return;\n    }\n\n    vec3 N = normalize(frag_pos);\n    vec2 uv = vec2(atan(N.z, N.x), acos(N.y)) / vec2(6.28318530718f, 3.14159265359f);\n    vec3 color;\n\n    #ifdef HEIGHT_MAP\n        if (show_height_map) {\n            color = texture(height_map, uv).rgb;\n        } \n        #ifdef SMOOTH_SHADING\n            else if (show_normal_map) {\n                color = texture(normal_map, uv).rgb;\n            } \n        #endif\n            else {\n                vec3 terrain_color;\n\n                #ifdef COLOR_MAP\n                    terrain_color = texture(color_map, uv).rgb;\n                #else\n                    #ifdef HEIGHT_MAP\n                        terrain_color = getTerrainColor(texture(height_map, uv).r);\n                    #else\n                        terrain_color = vec3(1.0);\n                    #endif\n                #endif\n\n                color = terrain_color;\n            }\n    #else\n        color = getLevelColor(v_level);\n    #endif\n\n    frag_color = vec4(color * getLighting(uv), 1.0);\n}\n`}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9),i=n(30),o=n(31);class a extends r.default{initPatch(){return new o.default(this.gl,this)}initVertices(){return[...a.icosahedron_vertices]}initFaces(){return[new i.default(0,11,5,this),new i.default(0,5,1,this),new i.default(0,1,7,this),new i.default(0,7,10,this),new i.default(0,10,11,this),new i.default(1,5,9,this),new i.default(5,11,4,this),new i.default(11,10,2,this),new i.default(10,7,6,this),new i.default(7,1,8,this),new i.default(3,9,4,this),new i.default(3,4,2,this),new i.default(3,2,6,this),new i.default(3,6,8,this),new i.default(3,8,9,this),new i.default(4,9,5,this),new i.default(2,4,11,this),new i.default(6,2,10,this),new i.default(8,6,7,this),new i.default(9,8,1,this)]}}a.icosahedron_vertices=[-.5257311121191336,.85065080835204,0,.5257311121191336,.85065080835204,0,-.5257311121191336,-.85065080835204,0,.5257311121191336,-.85065080835204,0,0,-.5257311121191336,.85065080835204,0,.5257311121191336,.85065080835204,0,-.5257311121191336,-.85065080835204,0,.5257311121191336,-.85065080835204,.85065080835204,0,-.5257311121191336,.85065080835204,0,.5257311121191336,-.85065080835204,0,-.5257311121191336,-.85065080835204,0,.5257311121191336],e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(10),i=n(29),o=n(1);e.default=class{constructor(t){this._camera=t,this._planes=[]}update(t){const e=t,n=Math.tan(this._camera.FOV),a=this._camera.aspectRatio,s=n*this._camera.near,u=s/a,c=n*this._camera.far,h=c/a,f=this._camera.basis,l=this._camera.position,d=o.sum(l,o.times(f.front,this._camera.far)),_=o.sum(l,o.times(f.front,this._camera.near)),p=o.transform(o.sum(_,o.times(f.up,u),o.times(f.right,-s)),e),v=o.transform(o.sum(_,o.times(f.up,u),o.times(f.right,s)),e),m=o.transform(o.sum(_,o.times(f.up,-u),o.times(f.right,-s)),e),g=o.transform(o.sum(_,o.times(f.up,-u),o.times(f.right,s)),e),M=o.transform(o.sum(d,o.times(f.up,h),o.times(f.right,-c)),e),b=o.transform(o.sum(d,o.times(f.up,h),o.times(f.right,c)),e),x=o.transform(o.sum(d,o.times(f.up,-h),o.times(f.right,-c)),e),y=o.transform(o.sum(d,o.times(f.up,-h),o.times(f.right,c)),e);this._planes=[new i.Plane(p,v,m),new i.Plane(b,M,y),new i.Plane(M,p,x),new i.Plane(v,b,g),new i.Plane(M,b,p),new i.Plane(m,g,x)],this.debug_lines=r.createLines([M,b,y,b,y,x,M,x,p,v,g,v,g,m,p,m,p,M,v,b,m,x,g,y])}get planes(){return this._planes}containsPoint(t){for(let e of this._planes)if(e.distanceToPoint(t)<0)return!1;return!0}containsTriangle(t,e,n){for(const r of this._planes)if(r.distanceToPoint(t)<0&&r.distanceToPoint(e)<0&&r.distanceToPoint(n)<0)return!1;return!0}containsRectangle(t,e,n,r){for(const i of this._planes)if(i.distanceToPoint(t)<0&&i.distanceToPoint(e)<0&&i.distanceToPoint(n)<0&&i.distanceToPoint(r)<0)return!1;return!0}containsVolume(t){for(const e of this._planes)if(t.every(t=>e.distanceToPoint(t)<0))return!1;return!0}getDebugLines(){return this.debug_lines}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wireFrameShader={vertex:"\n    in vec3 position;\n\n    uniform mat4 model_view_proj;\n\t\n\tvoid main() {\n\t\tgl_Position = model_view_proj * vec4(position, 1.0f);\n\t}\n    ",fragment:"\n    precision mediump float;\n\n    uniform vec3 color;\n\n    out vec4 frag_color;\n    \n    void main() {\n        frag_color = vec4(color, 1.0);\n    }"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pointShader={vertex:"\n    in vec3 position;\n\n    uniform mat4 model_view_proj;\n\t\n\tvoid main() {\n        gl_Position = model_view_proj * vec4(position, 1.0f);\n        gl_PointSize = 2.0f;\n\t}\n    ",fragment:"\n    precision mediump float;\n\n    uniform vec3 color;\n\n    out vec4 frag_color;\n    \n    void main() {\n        frag_color = vec4(color, 1.0);\n    }"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1);e.Plane=class{constructor(t,e,n){if(this._point=t,this._normal=i.normalize(i.cross(i.sub(n,t),i.sub(e,t))),r.vec3.equals(this._normal,i.fill(0)))throw new Error("Cannot construct a plane with aligned points");this._dist_to_origin=-r.vec3.dot(this._point,this._normal)}distanceToPoint(t){return r.vec3.dot(this._normal,t)+this._dist_to_origin}containsPoint(t,e=1e-4){return Math.abs(r.vec3.dot(i.sub(t,this._point),this._normal))<e}get point(){return this._point}get normal(){return this._normal}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(12);class i extends r.default{constructor(t,e,n,r,i=null){super([t,e,n],r,i)}split(){if(this._has_children)return;const[t,e,n]=this._indices,r=this.getMidPoint(t,e),o=this.getMidPoint(e,n),a=this.getMidPoint(t,n);this._children=[new i(r,a,t,this._sphere,this),new i(r,e,o,this._sphere,this),new i(n,a,o,this._sphere,this),new i(o,a,r,this._sphere,this)],this._has_children=!0}}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(13),i=n(4);e.default=class extends r.default{generateInstance(){return{vertices:[i.g_vec(0,0),i.g_vec(.5,0),i.g_vec(1,0),i.g_vec(0,.5),i.g_vec(.5,.5),i.g_vec(0,1)],morph:[i.g_vec(0,0),i.g_vec(-.5,0),i.g_vec(0,0),i.g_vec(0,.5),i.g_vec(.5,-.5),i.g_vec(0,0)],indices:[0,3,1,3,4,1,1,4,2,3,5,4]}}generateGeometry(){this._vertices=[],this._indices=[];let t=[],e=[];const n=1+2**this._levels,r=1/(n-1);let i=0,o=0;for(let a=0;a<n;a++){const s=n-a;o+=s;for(let u=0;u<s;u++){const c=[u/(n-1),a/(n-1)],h=[0,0];a%2==0?u%2==1&&(h[0]=-r,h[1]=0):u%2==0?(h[0]=0,h[1]=r):(h[0]=r,h[1]=-r),t.push(...c),e.push(...h),this._vertices.push(...c,...h),a<n-1&&u<s-1&&(this._indices.push(i+u),this._indices.push(o+u),this._indices.push(1+i+u),u<s-2&&(this._indices.push(o+u),this._indices.push(1+o+u),this._indices.push(1+i+u)))}i=o}this.rebind()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9),i=n(33),o=n(34);class a extends r.default{initPatch(){return new o.default(this.gl,this)}initVertices(){return[...a.cube_vertices]}initFaces(){return[new i.default(0,1,2,3,this),new i.default(4,5,6,7,this),new i.default(8,9,10,11,this),new i.default(12,13,14,15,this),new i.default(16,17,18,19,this),new i.default(20,21,22,23,this)]}}a.cube_vertices=[-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1,1,-1,1,1,1,1,1,1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1],e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(12);class i extends r.default{constructor(t,e,n,r,i,o=null){super([t,e,r,n],i,o)}mapToUnitSphere(t){return t}split(){if(this._has_children)return;const[t,e,n,r]=this._indices,o=this.getMidPoint(t,e),a=this.getMidPoint(e,r),s=this.getMidPoint(r,n),u=this.getMidPoint(t,n),c=this._sphere.addVertex(this.centroid);this._children=[new i(t,o,c,u,this._sphere,this),new i(o,e,a,c,this._sphere,this),new i(c,a,r,s,this._sphere,this),new i(u,c,s,n,this._sphere,this)],this._has_children=!0}}e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(4),i=n(13);e.default=class extends i.default{generateInstance(){const t=r.g_vec(0,0),e=r.g_vec(1,0),n=r.g_vec(1,1),i=r.g_vec(0,1),o=r.g_vec(.5,0),a=r.g_vec(.5,.5),s=r.g_vec(0,.5),u=r.g_vec(1,.5),c=r.g_vec(.5,1);return{vertices:[t,o,a,s,o,e,u,a,a,u,n,c,s,a,c,i],morph:[r.g_vec(0,0),r.g_vec(.5,0),r.g_vec(.5,.5),r.g_vec(0,.5),r.g_vec(-.5,0),r.g_vec(0,0),r.g_vec(0,.5),r.g_vec(-.5,.5),r.g_vec(-.5,-.5),r.g_vec(0,-.5),r.g_vec(0,0),r.g_vec(-.5,0),r.g_vec(0,-.5),r.g_vec(.5,-.5),r.g_vec(.5,0),r.g_vec(0,0)],indices:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12]}}generateGeometry(){const t=this._levels,e=this.generateInstance(),n=e.vertices.map(e=>r.g_scale(e,1/t));this._vertices=[],this._indices=[];for(let i=0;i<=1-1/t;i+=1/t)for(let o=0;o<=1-1/t;o+=1/t){const t=r.g_vec(i,o);e.indices.forEach(t=>{this._indices.push(t+this._vertices.length/4)}),n.forEach((n,i)=>{this._vertices.push(...r.g_add(n,t),...e.morph[i])})}this.rebind()}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this._planets=[]}add(...t){this._planets.push(...t)}update(t){for(const e of this._planets)e.update(t),e.sphere.updateFrustum()}render(t,e){for(const n of this._planets.values())n.render(t,e)}get planets(){return this._planets}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.last_tick=Date.now()}getDelta(){const t=Date.now(),e=t-this.last_tick;return this.last_tick=t,e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(15),i=n(5);e.heightMapShader={vertex:"\n    in vec2 position;\n    out vec2 a_pos;\n    \n    void main() {\n        a_pos = position;\n        gl_Position = vec4(position, 0.0, 1.0);\n    }",fragment:`\n    precision mediump float;\n\n    in vec2 a_pos;\n    out vec4 color;\n    \n    ${r.simplex_noise4D("snoise")}\n    \n    float fbm(in vec3 st) {\n         // Initial values\n         float value = 0.0f;\n         float amplitude = 0.5f;\n         // Loop of octaves\n         for (int i = 0; i < OCTAVES; i++) {\n             value += amplitude * snoise(vec4(st, SEED));\n             st *= 2.0f;\n             amplitude *= 0.5f;\n         }\n    \n     return value;\n    }\n    \n    ${i.spherize()}\n\n    void main() {\n    \n        vec2 st = a_pos * 0.5f + 0.5f;\n    \n        float n = fbm(spherize(st) * FREQUENCY) * 0.5f + 0.5f;\n\n        // n = pow(n, 2.5f);\n\n        // n = clamp(n, 0.499f, 1.0f);\n    \n        color = vec4(vec3(n), 1.0f);\n    }\n    `}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.normalMapShader={vertex:"\n    in vec2 position;\n\n    out vec2 a_pos;\n\n    void main() {\n        a_pos = position * 0.5f + 0.5f;\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n    ",fragment:"\n    precision mediump float;\n\n    #define USE_SOBEL\n    #define SENSITIVITY 1.0f\n    \n    in vec2 a_pos;\n    \n    out vec4 FragColor;\n    \n    uniform sampler2D height_map;\n    \n    void main() {\n    \n        vec2 uv = a_pos;\n        vec3 n;\n    \n        #ifdef USE_SOBEL\n            float h00 = textureOffset(height_map, uv, ivec2(-1, -1)).r;\n            float h10 = textureOffset(height_map, uv, ivec2(0, -1)).r;\n            float h20 = textureOffset(height_map, uv, ivec2(1, -1)).r;\n            float h01 = textureOffset(height_map, uv, ivec2(-1, 0)).r;\n            float h21 = textureOffset(height_map, uv, ivec2(1, 0)).r;\n            float h02 = textureOffset(height_map, uv, ivec2(-1, 1)).r;\n            float h12 = textureOffset(height_map, uv, ivec2(0, 1)).r;\n            float h22 = textureOffset(height_map, uv, ivec2(1, 1)).r;\n    \n            float Gx = h00 - h20 + 2.0f * h01 - 2.0f * h21 + h02 - h22;\n            float Gy = h00 + 2.0f * h10 + h20 - h02 - 2.0f * h12 - h22;\n            float Gz = SENSITIVITY * sqrt(1.0f - Gx * Gx - Gy * Gy);\n            n = vec3(2.0f * Gx, 2.0f * Gy, Gz);\n        #else\n            float h0 = texture(height_map, uv).r;\n            float h1 = textureOffset(height_map, uv, ivec2(1, 0)).r;\n            float h2 = textureOffset(height_map, uv, ivec2(0, 1)).r;\n    \n            vec3 v01 = vec3(1.0, 0.0, h1 - h0);\n            vec3 v02 = vec3(0, 1, h2 - h0);\n    \n            n = cross(v01, v02);\n            n.z *= SENSITIVITY;\n        #endif\n    \n        n = normalize(n) * 0.5f + 0.5f;\n\n        FragColor = vec4(n, 1.0f);\n    }\n    "}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.plainColorShader={vertex:"\n    in vec4 position;\n    \n    void main() {\n        gl_Position = position;\n    }\n    ",fragment:"\n    precision mediump float;\n\n    uniform vec3 color;\n    out vec4 frag_color;\n    \n    void main() {\n        frag_color = vec4(color, 1.0);\n    }"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(8);e.heightMapToColorMapShader={vertex:"\n    in vec2 position;\n    out vec2 v_texcoord;\n    \n    void main() {\n        v_texcoord = position * 0.5f + 0.5f;\n        gl_Position = vec4(position, 0.0, 1.0);\n    }\n    ",fragment:`\n    precision mediump float;\n\n    in vec2 v_texcoord;\n\n    uniform sampler2D height_map;\n\n    out vec4 frag_color;\n    \n    ${r.getTerrainColor()}\n\n    void main() {\n        vec3 color = getTerrainColor(texture(height_map, v_texcoord).r);\n        frag_color = vec4(color, 1.0);\n    }`}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(15),i=n(5);e.clampedHeightMapShader={vertex:"\n    in vec2 position;\n    out vec2 a_pos;\n    \n    void main() {\n        a_pos = position;\n        gl_Position = vec4(position, 0.0, 1.0);\n    }",fragment:`\n    precision mediump float;\n\n    in vec2 a_pos;\n\n    uniform float clamp_height;\n\n    out vec4 color;\n    \n    ${r.simplex_noise4D("snoise")}\n    \n    float fbm(in vec3 st) {\n         // Initial values\n         float value = 0.0f;\n         float amplitude = 0.5f;\n         // Loop of octaves\n         for (int i = 0; i < OCTAVES; i++) {\n             value += amplitude * snoise(vec4(st, SEED));\n             st *= 2.0f;\n             amplitude *= 0.5f;\n         }\n    \n     return value;\n    }\n    \n    ${i.spherize()}\n\n    void main() {\n    \n        vec2 st = a_pos * 0.5f + 0.5f;\n    \n        float h = fbm(spherize(st) * FREQUENCY) * 0.5f + 0.5f;\n\n        if (h < clamp_height) {\n            h = 0.0f;\n        } else {\n            // map [clamp_height, 1.0] to [0.0, 1.0]\n            h = (h - clamp_height) * (1.0 / (1.0 - clamp_height));\n        }\n\n        color = vec4(vec3(h), 1.0f);\n    }\n    `}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.textShader={vertex:"\n    in vec4 position;\n    in vec2 texcoords;\n    \n    uniform mat4 transfo;\n    \n    out vec2 v_texcoord;\n    \n    void main() {\n      gl_Position = transfo * (position * 2.0) - 1.0;\n  \n      v_texcoord = texcoords;\n    }\n    ",fragment:"\n    precision mediump float;\n    \n    uniform sampler2D u_texture;\n    in vec2 v_texcoord;\n    \n    out vec4 outColor;\n    \n    void main() {\n\n      vec4 color = texture(u_texture, v_texcoord);\n      \n/*       if (color.rgb == vec3(0.0)) {\n        discard;\n      } */\n\n      outColor = vec4(color);\n    }\n    "}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(44),i=n(4),o=document.createElement("canvas").getContext("2d");e.createTextHelper=function(t,e){const n=r.createCanvasHelper(t);let i,a;return(t,r)=>(a!==t&&(a=t,i=function(t,e){const n=Object.assign({color:"tomato",font_size:35,font_family:"monospace, sans-serif",margin:5,background_color:"rgba(0, 0, 0, 0)"},e);o.font=`${n.font_size}px ${n.font_family}`;const r=o.measureText(t).width+n.margin,i=n.font_size+n.margin;return o.canvas.width=r,o.canvas.height=i,o.font=`${n.font_size}px ${n.font_family}`,o.textAlign="center",o.textBaseline="middle",o.fillStyle=n.background_color,o.fillRect(0,0,r,i),o.fillStyle=n.color,o.fill(),o.fillText(t,r/2,i/2),o.canvas}(t,e)),n(i,r),{width:i.width,height:i.height})},e.createPlotHelper=function(t,e){const n=r.createCanvasHelper(t),o=document.createElement("canvas");o.width=e.width,o.height=e.height;const a=o.getContext("2d");return e=Object.assign({color:"blue",background_color:"white",line_width:1,auto_scale:!0,normalized:!1},e),(t,...r)=>{if(e.normalized&&(r=r.map(t=>i.g_prod(t,[o.width,o.height]))),e.auto_scale){const t=i.getBoundingBox(...r);r=r.map(n=>i.mapBox(n,t,{min:[0,0],max:[e.width,e.height]}))}a.clearRect(0,0,o.width,o.height),a.fillStyle=e.background_color,a.fillRect(0,0,o.width,o.height),a.fill(),a.strokeStyle=e.color,a.beginPath(),a.moveTo(r[0][0],r[0][1]);for(const t of r.slice(1))a.lineTo(t[0],t[1]);a.stroke(),a.closePath(),n(o,t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(16);e.createCanvasHelper=function(t){const e=r.createTextureHelper(t),n=t.createTexture();return(r,i,o)=>{t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.generateMipmap(t.TEXTURE_2D);const a={handle:n,width:r.width,height:r.height,bound_to:0};e(a,i,o)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(14);e.generateEarthyTextures=function(t,e){const n=e,i=e/2,o=r.Texture.generateClampedHeightMap(t,n,i,.5);return{height_map:o,normal_map:r.Texture.generateNormalMap(t,o)}},e.generateMoonyTextures=function(t,e){const n=e,i=e/2,o=r.Texture.generateHeightMap(t,n,i);return{height_map:o,color_map:o}}}]);